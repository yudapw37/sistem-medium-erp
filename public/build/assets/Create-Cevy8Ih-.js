import{T as R,r as _,J as U,A as $,E as z,a as d,c as A,w as F,b as n,u as l,Z as N,d as e,g as i,t as o,h as m,k as x,v as p,F as P,p as S,O as E}from"./app-DA0EYa_6.js";import{I as G}from"./IconArrowLeft-gRB0gwWT.js";import{I as O}from"./IconSearch-hVNvfgeb.js";import{I as J}from"./IconTrash-BZm3hFVP.js";import{_ as L}from"./DashboardLayout-DqHF1oae.js";import{_ as f}from"./Button-mcRGNCmf.js";import{_ as V}from"./InputSelect-BqzyB0VS.js";import{l as Q}from"./lodash-De9ynbB3.js";import"./createVueComponent-CUBUAVU4.js";import"./IconUsers-CzMPbSiM.js";import"./IconSun-9pmbsCzq.js";import"./IconFileInvoice-DqQY055S.js";import"./IconReceipt-DjQT6mN-.js";import"./IconShoppingCart-qle56F5S.js";import"./IconCircleFilled-C8aRf-1y.js";const W={class:"mb-6"},H={class:"flex items-center justify-between"},K={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},M={class:"lg:col-span-1 space-y-6"},Z={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},X={class:"space-y-4"},Y={key:0,class:"p-4 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700"},ee={class:"font-medium text-slate-900 dark:text-white"},te={class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},se={class:"text-sm text-slate-500 dark:text-slate-400"},re={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},ae={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},le={key:0,class:"text-sm text-red-500 mt-1"},oe={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},de={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},ie={class:"relative"},ne={class:"flex items-center gap-2 mb-2"},ce={key:0,class:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-xl max-h-64 overflow-y-auto"},ue=["onClick"],be={class:"flex items-center gap-3"},me={class:"w-10 h-10 rounded-lg bg-slate-100 dark:bg-slate-700 flex-shrink-0"},xe=["src"],pe={class:"font-medium text-slate-900 dark:text-white text-sm"},he={class:"text-xs text-slate-500"},ge={class:"ml-auto text-right"},_e={class:"text-xs font-semibold text-slate-700 dark:text-slate-300"},ke={class:"lg:col-span-2"},fe={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6 h-full flex flex-col"},ve={class:"flex-1 overflow-x-auto"},we={class:"w-full"},ye={class:"divide-y divide-slate-100 dark:divide-slate-700"},Ce={key:0},Ie={class:"py-3 pl-2"},Pe={class:"flex flex-col"},Se={class:"font-medium text-slate-900 dark:text-white text-sm"},Ve={class:"text-xs text-slate-500"},je={class:"py-3 text-right"},Be=["onUpdate:modelValue"],Te={class:"py-3 text-center"},qe=["onUpdate:modelValue"],De={class:"py-3 text-right font-medium text-slate-900 dark:text-white text-sm"},Re={class:"py-3 text-center"},Ue=["onClick"],$e={class:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-700"},ze={class:"flex justify-between items-center mb-6"},Ae={class:"text-2xl font-bold text-primary-600 dark:text-primary-400"},Fe={class:"flex justify-end gap-3"},tt={__name:"Create",props:{Customers:Array,warehouses:Array},setup(v){const a=R({Customer_id:"",warehouse_id:"",date:new Date().toISOString().split("T")[0],grand_total:0,items:[]}),c=_(null),w=_(null),u=_(""),b=_([]),j=s=>{c.value=s,a.Customer_id=s?s.id:""},B=s=>{w.value=s,a.warehouse_id=s?s.id:""},y=Q.debounce(async()=>{if(!u.value){b.value=[];return}try{const s=await U.post(h("sale-returns.searchProduct"),{q:u.value});b.value=s.data}catch(s){console.error(s)}},300),T=s=>{const t=a.items.find(r=>r.product_id===s.id);t?t.qty++:a.items.push({product_id:s.id,title:s.title,barcode:s.barcode,sell_price:s.sell_price,qty:1}),u.value="",b.value=[]},q=s=>{a.items.splice(s,1)},C=$(()=>a.items.reduce((s,t)=>s+t.sell_price*t.qty,0));z(C,s=>{a.grand_total=s});const D=()=>{a.post(h("sale-returns.store"))},I=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s||0),h=(s,t)=>typeof window<"u"&&window.route?window.route(s,t):"#";return(s,t)=>(d(),A(L,null,{default:F(()=>[n(l(N),{title:"Return Penjualan Baru"}),e("div",W,[e("div",H,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Return Penjualan Baru"),e("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Buat transaksi Return Penjualan stok baru. ")],-1)),n(f,{type:"link",icon:l(G),class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",label:"Kembali",href:h("sale-returns.index")},null,8,["icon","href"])])]),e("div",K,[e("div",M,[e("div",Z,[t[6]||(t[6]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Informasi Customer",-1)),e("div",X,[n(V,{label:"Pilih Customer",data:v.Customers,selected:c.value,"set-selected":j,placeholder:"Pilih Customer...",searchable:!0,errors:l(a).errors.Customer_id},null,8,["data","selected","errors"]),c.value?(d(),i("div",Y,[e("p",ee,o(c.value.name),1),e("p",te,o(c.value.address||"-"),1),e("p",se,o(c.value.phone||"-"),1)])):m("",!0)])]),e("div",re,[t[7]||(t[7]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Gudang Tujuan",-1)),n(V,{label:"Pilih Gudang",data:v.warehouses,selected:w.value,"set-selected":B,placeholder:"Pilih Gudang...",searchable:!0,errors:l(a).errors.warehouse_id},null,8,["data","selected","errors"])]),e("div",ae,[t[8]||(t[8]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Tanggal Return",-1)),x(e("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=r=>l(a).date=r),class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none"},null,512),[[p,l(a).date]]),l(a).errors.date?(d(),i("p",le,o(l(a).errors.date),1)):m("",!0)]),e("div",oe,[t[9]||(t[9]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Catatan",-1)),x(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=r=>l(a).notes=r),placeholder:"Catatan/keterangan (opsional)",class:"w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none resize-none",rows:"3"},null,512),[[p,l(a).notes]])]),e("div",de,[t[10]||(t[10]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Cari Produk",-1)),e("div",ie,[e("div",ne,[n(l(O),{size:20,class:"text-slate-400"}),x(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=r=>u.value=r),onInput:t[3]||(t[3]=(...r)=>l(y)&&l(y)(...r)),placeholder:"Scan barcode atau ketik nama...",class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none"},null,544),[[p,u.value]])]),b.value.length>0?(d(),i("div",ce,[(d(!0),i(P,null,S(b.value,r=>(d(),i("div",{key:r.id,onClick:k=>T(r),class:"p-3 hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer border-b border-slate-100 dark:border-slate-700 last:border-0"},[e("div",be,[e("div",me,[r.image?(d(),i("img",{key:0,src:r.image,class:"w-full h-full object-cover rounded-lg"},null,8,xe)):m("",!0)]),e("div",null,[e("p",pe,o(r.title),1),e("p",he,o(r.barcode),1)]),e("div",ge,[e("p",_e,"Stok: "+o(r.stock),1)])])],8,ue))),128))])):m("",!0)])])]),e("div",ke,[e("div",fe,[t[14]||(t[14]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Daftar Item",-1)),e("div",ve,[e("table",we,[t[12]||(t[12]=e("thead",null,[e("tr",{class:"border-b border-slate-100 dark:border-slate-700 text-left text-sm text-slate-500"},[e("th",{class:"pb-3 pl-2"},"Produk"),e("th",{class:"pb-3 text-right"},"Harga Jual"),e("th",{class:"pb-3 text-center w-24"},"Qty"),e("th",{class:"pb-3 text-right"},"Subtotal"),e("th",{class:"pb-3 w-10"})])],-1)),e("tbody",ye,[l(a).items.length===0?(d(),i("tr",Ce,[...t[11]||(t[11]=[e("td",{colspan:"5",class:"py-8 text-center text-slate-500 italic text-sm"}," Belum ada item dipilih ",-1)])])):m("",!0),(d(!0),i(P,null,S(l(a).items,(r,k)=>(d(),i("tr",{key:k,class:"group"},[e("td",Ie,[e("div",Pe,[e("span",Se,o(r.title),1),e("span",Ve,o(r.barcode),1)])]),e("td",je,[x(e("input",{type:"number","onUpdate:modelValue":g=>r.sell_price=g,min:"0",class:"w-32 px-2 py-1 text-right text-sm rounded-lg border border-slate-200 bg-slate-50 focus:border-primary-500 focus:ring-0 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,Be),[[p,r.sell_price]])]),e("td",Te,[x(e("input",{type:"number","onUpdate:modelValue":g=>r.qty=g,min:"0",class:"w-20 px-2 py-1 text-center text-sm rounded-lg border border-slate-200 bg-slate-50 focus:border-primary-500 focus:ring-0 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,qe),[[p,r.qty]])]),e("td",De,o(I(r.sell_price*r.qty)),1),e("td",Re,[e("button",{onClick:g=>q(k),class:"text-slate-400 hover:text-danger-500 transition-colors"},[n(l(J),{size:18})],8,Ue)])]))),128))])])]),e("div",$e,[e("div",ze,[t[13]||(t[13]=e("span",{class:"text-lg font-bold text-slate-700 dark:text-slate-300"},"Total Return Penjualan",-1)),e("span",Ae,o(I(C.value)),1)]),e("div",Fe,[n(f,{type:"button",label:"Batal",class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",onClick:t[4]||(t[4]=r=>l(E).visit(h("sale-returns.index")))}),n(f,{type:"submit",label:"Simpan Transaksi",class:"bg-primary-500 hover:bg-primary-600 text-white shadow-lg shadow-primary-500/30",processing:l(a).processing,disabled:l(a).items.length===0||!l(a).Customer_id||!l(a).warehouse_id,onClick:D},null,8,["processing","disabled"])])])])])])]),_:1}))}};export{tt as default};
