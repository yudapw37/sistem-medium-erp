import{r as v,a as u,g as m,d as e,b as l,u as s,e as b,F as w,p as $,k as x,x as D,t as y,v as k,m as I,h as z,O as j,Q as T,i as M,T as A,C as E,L as N,c as P,w as U,Z as H,j as S,f as K}from"./app-CIYeQ-4j.js";import{I as L}from"./IconArrowLeft-D_cLVqwd.js";import{I as O,a as F}from"./IconCurrencyDollar-D9jU5xOU.js";import{I as G}from"./IconDeviceFloppy-DbcGo2jm.js";import{i as B,h as R,_ as J}from"./DashboardLayout-CDE7-Y8V.js";import{I as C}from"./IconPhoto-Dejbk6Jm.js";import{g as q}from"./imageUrl-DBqZIQ1M.js";import{_ as Q}from"./TextArea-B8lJlxzM.js";import{_ as Z}from"./InputSelect-CCGvz5pc.js";import{_ as W}from"./Checkbox-Ci1msxok.js";import{I as X}from"./IconPlus-GQDXKtBl.js";import{I as Y}from"./IconTrash-CUcDdroG.js";import"./createVueComponent-Cyzcg1Tn.js";import"./IconUsers-lhp4zDA0.js";import"./IconSun-B2kMHmLk.js";import"./IconFileInvoice-CDLMKT3Q.js";import"./IconReceipt-CzHzcLcH.js";import"./IconShoppingCart-C-7we8qa.js";import"./IconCircleFilled-CJHeZp2T.js";const ee={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5"},te={class:"flex items-center justify-between mb-4"},se={class:"text-sm font-semibold text-slate-700 dark:text-slate-300 flex items-center gap-2"},oe={key:0,class:"text-center py-6 text-slate-500"},re={key:1,class:"space-y-3"},le={class:"flex items-center gap-4 mb-3"},ae={class:"flex-1"},de=["onUpdate:modelValue"],ie=["value"],ne={class:"w-24"},ue=["onUpdate:modelValue"],ce=["onClick"],pe={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},me=["onUpdate:modelValue"],be=["onUpdate:modelValue"],ge=["onUpdate:modelValue"],xe={class:"flex items-end gap-4"},_e={class:"flex items-center gap-2 text-xs"},fe=["onUpdate:modelValue","onChange"],ke={class:"flex items-center gap-2 text-xs"},ve=["onUpdate:modelValue"],ye={key:2,class:"mt-4 flex justify-end"},he=["disabled"],Ve={__name:"ProductUnitManager",props:{productId:Number,units:Array,productUnits:Array},setup(c){const i=c,d=v([...i.productUnits.map(n=>({unit_id:n.unit_id,conversion_rate:parseFloat(n.conversion_rate),barcode:n.barcode||"",sell_price:n.sell_price,buy_price:n.buy_price,is_base:n.is_base,is_default:n.is_default}))]),g=v(!1),a=()=>{d.value.push({unit_id:"",conversion_rate:1,barcode:"",sell_price:0,buy_price:0,is_base:d.value.length===0,is_default:d.value.length===0})},_=n=>{d.value.splice(n,1)},f=n=>{d.value.forEach((o,t)=>{t!==n&&(o.is_base=!1)}),d.value[n].conversion_rate=1},h=()=>{g.value=!0,j.post(V("products.sync-units",i.productId),{units:d.value},{preserveScroll:!0,onSuccess:()=>{g.value=!1},onError:()=>{g.value=!1}})},V=(n,o)=>typeof window<"u"&&window.route?window.route(n,o):"#";return(n,o)=>(u(),m("div",ee,[e("div",te,[e("h3",se,[l(s(B),{size:18}),o[0]||(o[0]=b(" Satuan Produk ",-1))]),e("button",{type:"button",onClick:a,class:"text-sm text-primary-600 hover:text-primary-700 font-medium flex items-center gap-1"},[l(s(X),{size:16}),o[1]||(o[1]=b(" Tambah Satuan ",-1))])]),d.value.length===0?(u(),m("div",oe,[l(s(B),{size:32,class:"mx-auto mb-2 text-slate-400"}),o[2]||(o[2]=e("p",{class:"text-sm"},"Belum ada satuan. Tambahkan satuan untuk menggunakan multi-barcode.",-1))])):(u(),m("div",re,[(u(!0),m(w,null,$(d.value,(t,p)=>(u(),m("div",{key:p,class:"border border-slate-200 dark:border-slate-700 rounded-xl p-4"},[e("div",le,[e("div",ae,[o[4]||(o[4]=e("label",{class:"text-xs text-slate-500 mb-1 block"},"Satuan",-1)),x(e("select",{"onUpdate:modelValue":r=>t.unit_id=r,class:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-700 rounded-lg dark:bg-slate-800"},[o[3]||(o[3]=e("option",{value:""},"Pilih Satuan",-1)),(u(!0),m(w,null,$(c.units,r=>(u(),m("option",{key:r.id,value:r.id},y(r.name),9,ie))),128))],8,de),[[D,t.unit_id]])]),e("div",ne,[o[5]||(o[5]=e("label",{class:"text-xs text-slate-500 mb-1 block"},"Konversi",-1)),x(e("input",{"onUpdate:modelValue":r=>t.conversion_rate=r,type:"number",step:"0.01",min:"1",class:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-700 rounded-lg dark:bg-slate-800"},null,8,ue),[[k,t.conversion_rate,void 0,{number:!0}]])]),e("button",{type:"button",onClick:r=>_(p),class:"p-2 text-red-500 hover:bg-red-50 rounded-lg"},[l(s(Y),{size:16})],8,ce)]),e("div",pe,[e("div",null,[o[6]||(o[6]=e("label",{class:"text-xs text-slate-500 mb-1 block"},"Barcode",-1)),x(e("input",{"onUpdate:modelValue":r=>t.barcode=r,type:"text",placeholder:"Barcode",class:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-700 rounded-lg dark:bg-slate-800"},null,8,me),[[k,t.barcode]])]),e("div",null,[o[7]||(o[7]=e("label",{class:"text-xs text-slate-500 mb-1 block"},"Harga Beli",-1)),x(e("input",{"onUpdate:modelValue":r=>t.buy_price=r,type:"number",min:"0",class:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-700 rounded-lg dark:bg-slate-800"},null,8,be),[[k,t.buy_price,void 0,{number:!0}]])]),e("div",null,[o[8]||(o[8]=e("label",{class:"text-xs text-slate-500 mb-1 block"},"Harga Jual",-1)),x(e("input",{"onUpdate:modelValue":r=>t.sell_price=r,type:"number",min:"0",class:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-700 rounded-lg dark:bg-slate-800"},null,8,ge),[[k,t.sell_price,void 0,{number:!0}]])]),e("div",xe,[e("label",_e,[x(e("input",{type:"checkbox","onUpdate:modelValue":r=>t.is_base=r,onChange:r=>f(p),class:"rounded"},null,40,fe),[[I,t.is_base]]),o[9]||(o[9]=e("span",null,"Base",-1))]),e("label",ke,[x(e("input",{type:"checkbox","onUpdate:modelValue":r=>t.is_default=r,class:"rounded"},null,8,ve),[[I,t.is_default]]),o[10]||(o[10]=e("span",null,"Default",-1))])])])]))),128))])),d.value.length>0?(u(),m("div",ye,[e("button",{type:"button",onClick:h,disabled:g.value,class:"px-4 py-2 text-sm bg-primary-500 hover:bg-primary-600 text-white rounded-lg disabled:opacity-50"},y(g.value?"Menyimpan...":"Simpan Satuan"),9,he)])):z("",!0)]))}},Ue={class:"mb-6"},we={class:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2"},$e={class:"text-sm text-slate-500 mt-1"},Ie={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Pe={class:"lg:col-span-1"},Se={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5"},Be={class:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-4 flex items-center gap-2"},Ce={class:"aspect-square rounded-xl bg-slate-100 dark:bg-slate-800 border-2 border-dashed border-slate-300 dark:border-slate-700 flex items-center justify-center overflow-hidden mb-4"},ze=["src"],De={key:1,class:"text-center p-6"},je={class:"lg:col-span-2 space-y-6"},Te={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5"},Me={class:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-4 flex items-center gap-2"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ee={class:"md:col-span-2"},Ne={class:"md:col-span-2"},He={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5"},Ke={class:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-4 flex items-center gap-2"},Le={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Oe={class:"md:col-span-4 flex items-center gap-2 mt-2"},Fe={class:"flex justify-end gap-3"},Ge=["disabled"],ct={__name:"Edit",props:{categories:Array,product:Object,units:Array,productUnits:Array},setup(c){const i=c,{errors:d}=T().props,g=M(),a=A({image:"",barcode:i.product.barcode,title:i.product.title,category_id:i.product.category_id,description:i.product.description,buy_price:i.product.buy_price,sell_price:i.product.sell_price,weight:i.product.weight??0,stock:i.product.stock,is_sellable:i.product.is_sellable,_method:"PUT"}),_=v(null),f=v(i.product.image?q(i.product.image):null);E(()=>{i.product.category_id&&(_.value=i.categories.find(o=>o.id===i.product.category_id))});const h=o=>{_.value=o,a.category_id=(o==null?void 0:o.id)||""},V=o=>{const t=o.target.files[0];t&&(a.image=t,f.value=URL.createObjectURL(t))},n=()=>{a.post(route("products.update",i.product.id),{onSuccess:()=>g.success("Produk berhasil diperbarui"),onError:()=>g.error("Gagal memperbarui produk")})};return(o,t)=>{const p=N("Input");return u(),P(J,null,{default:U(()=>[l(s(H),{title:"Edit Produk"}),e("div",Ue,[l(s(S),{href:o.route("products.index"),class:"inline-flex items-center gap-2 text-sm text-slate-500 hover:text-primary-600 mb-3"},{default:U(()=>[l(s(L),{size:16}),t[8]||(t[8]=b(" Kembali ke Produk ",-1))]),_:1},8,["href"]),e("h1",we,[l(s(R),{size:28,class:"text-primary-500"}),t[9]||(t[9]=b(" Edit Produk ",-1))]),e("p",$e,y(c.product.title),1)]),e("form",{onSubmit:K(n,["prevent"])},[e("div",Ie,[e("div",Pe,[e("div",Se,[e("h3",Be,[l(s(C),{size:18}),t[10]||(t[10]=b(" Gambar Produk ",-1))]),e("div",Ce,[f.value?(u(),m("img",{key:0,src:f.value,alt:"Preview",class:"w-full h-full object-cover"},null,8,ze)):(u(),m("div",De,[l(s(C),{size:48,class:"mx-auto text-slate-400 mb-2"}),t[11]||(t[11]=e("p",{class:"text-sm text-slate-500"},"Belum ada gambar",-1))]))]),l(p,{type:"file",label:"Ganti Gambar",onChange:V,errors:s(d).image,accept:"image/*"},null,8,["errors"])])]),e("div",je,[e("div",Te,[e("h3",Me,[l(s(O),{size:18}),t[12]||(t[12]=b(" Informasi Dasar ",-1))]),e("div",Ae,[e("div",Ee,[l(Z,{label:"Kategori",data:c.categories,selected:_.value,"set-selected":h,placeholder:"Pilih kategori",errors:s(d).category_id,searchable:!0,"display-key":"name"},null,8,["data","selected","errors"])]),l(p,{type:"text",label:"Barcode / SKU",modelValue:s(a).barcode,"onUpdate:modelValue":t[0]||(t[0]=r=>s(a).barcode=r),errors:s(d).barcode,placeholder:"Kode produk"},null,8,["modelValue","errors"]),l(p,{type:"text",label:"Nama Produk",modelValue:s(a).title,"onUpdate:modelValue":t[1]||(t[1]=r=>s(a).title=r),errors:s(d).title,placeholder:"Nama produk"},null,8,["modelValue","errors"]),e("div",Ne,[l(Q,{label:"Deskripsi",placeholder:"Deskripsi produk",errors:s(d).description,modelValue:s(a).description,"onUpdate:modelValue":t[2]||(t[2]=r=>s(a).description=r),rows:3},null,8,["errors","modelValue"])])])]),e("div",He,[e("h3",Ke,[l(s(F),{size:18}),t[13]||(t[13]=b(" Harga & Stok ",-1))]),e("div",Le,[l(p,{type:"number",label:"Harga Beli",modelValue:s(a).buy_price,"onUpdate:modelValue":t[3]||(t[3]=r=>s(a).buy_price=r),errors:s(d).buy_price,placeholder:"0"},null,8,["modelValue","errors"]),l(p,{type:"number",label:"Harga Jual",modelValue:s(a).sell_price,"onUpdate:modelValue":t[4]||(t[4]=r=>s(a).sell_price=r),errors:s(d).sell_price,placeholder:"0"},null,8,["modelValue","errors"]),l(p,{type:"number",label:"Berat (gram)",modelValue:s(a).weight,"onUpdate:modelValue":t[5]||(t[5]=r=>s(a).weight=r),errors:s(d).weight,placeholder:"0"},null,8,["modelValue","errors"]),l(p,{type:"number",label:"Stok",modelValue:s(a).stock,"onUpdate:modelValue":t[6]||(t[6]=r=>s(a).stock=r),errors:s(d).stock,placeholder:"0"},null,8,["modelValue","errors"]),e("div",Oe,[l(W,{checked:s(a).is_sellable,"onUpdate:checked":t[7]||(t[7]=r=>s(a).is_sellable=r),id:"is_sellable"},null,8,["checked"]),t[14]||(t[14]=e("label",{for:"is_sellable",class:"text-sm font-medium text-slate-700 dark:text-slate-300 cursor-pointer"}," Dapat Dijual (Tampil di POS) ",-1))])])]),c.units&&c.units.length>0?(u(),P(Ve,{key:0,"product-id":c.product.id,units:c.units,"product-units":c.productUnits||[]},null,8,["product-id","units","product-units"])):z("",!0),e("div",Fe,[l(s(S),{href:o.route("products.index"),class:"px-6 py-2.5 rounded-xl border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 font-medium transition-colors"},{default:U(()=>[...t[15]||(t[15]=[b(" Batal ",-1)])]),_:1},8,["href"]),e("button",{type:"submit",disabled:s(a).processing,class:"inline-flex items-center gap-2 px-6 py-2.5 rounded-xl bg-primary-500 hover:bg-primary-600 text-white font-medium transition-colors disabled:opacity-50"},[l(s(G),{size:18}),b(" "+y(s(a).processing?"Menyimpan...":"Simpan Perubahan"),1)],8,Ge)])])])],32)]),_:1})}}};export{ct as default};
