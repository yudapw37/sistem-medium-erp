import{T as D,r as g,J as N,A as P,a as o,c as $,w as A,b as c,u as a,Z as F,d as t,t as d,k as b,v as p,g as n,h as _,F as V,p as q,O as H}from"./app-CIYeQ-4j.js";import{I as O}from"./IconArrowLeft-D_cLVqwd.js";import{I as T}from"./IconTrash-CUcDdroG.js";import{_ as z}from"./DashboardLayout-CDE7-Y8V.js";import{_ as h}from"./Button-CxuUSqWK.js";import{_ as R}from"./InputSelect-CCGvz5pc.js";import{l as J}from"./lodash-Dim8PIC9.js";import"./createVueComponent-Cyzcg1Tn.js";import"./IconUsers-lhp4zDA0.js";import"./IconSun-B2kMHmLk.js";import"./IconFileInvoice-CDLMKT3Q.js";import"./IconReceipt-CzHzcLcH.js";import"./IconShoppingCart-C-7we8qa.js";import"./IconCircleFilled-CJHeZp2T.js";const K={class:"mb-6"},L={class:"flex items-center justify-between"},Q={class:"text-sm text-slate-500 dark:text-slate-400"},M={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Z={class:"lg:col-span-1 space-y-6"},G={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},W={class:"space-y-4"},X={key:0,class:"text-sm text-red-500 mt-1"},Y={key:0,class:"text-sm text-red-500 mt-1"},tt={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},et={class:"relative"},st={key:0,class:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 rounded-xl border shadow-xl max-h-64 overflow-y-auto"},lt=["onClick"],rt={class:"font-medium text-slate-900 dark:text-white text-sm"},at={class:"text-xs text-slate-500"},dt={class:"lg:col-span-2"},ot={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},it={class:"w-full"},nt={class:"divide-y divide-slate-100 dark:divide-slate-700"},ut={key:0},ct={class:"py-3"},bt={class:"font-medium text-slate-900 dark:text-white text-sm"},pt={class:"py-3 text-right text-sm"},mt={class:"py-3 text-center"},xt=["onUpdate:modelValue"],kt={class:"py-3 text-right font-medium text-sm"},_t={class:"py-3 text-center"},ft=["onClick"],vt={class:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-700"},gt={class:"flex justify-between items-center mb-2"},ht={class:"text-lg"},yt={class:"flex justify-between items-center mb-2"},wt={class:"text-lg font-bold text-primary-600"},Bt={class:"flex justify-between items-center mb-6"},Ct={class:"text-lg font-bold text-success-600"},It={class:"flex justify-end gap-3"},Tt={__name:"Edit",props:{bundle:Object,products:Array},setup(y){const i=y,l=D({code:i.bundle.code,name:i.bundle.name,description:i.bundle.description||"",sell_price:i.bundle.sell_price,is_active:i.bundle.is_active,items:i.bundle.items.map(r=>{var e,s;return{product_id:r.product_id,title:(e=r.product)==null?void 0:e.title,sell_price:(s=r.product)==null?void 0:s.sell_price,qty:r.qty}})}),f=[{id:1,name:"Aktif",value:!0},{id:0,name:"Nonaktif",value:!1}],w=g(i.bundle.is_active?f[0]:f[1]),U=r=>{w.value=r,l.is_active=r.value},m=g(""),x=g([]),B=J.debounce(async()=>{if(!m.value){x.value=[];return}try{const r=await N.post(k("product-bundles.searchProduct"),{q:m.value});x.value=r.data}catch(r){console.error(r)}},300),E=r=>{const e=l.items.find(s=>s.product_id===r.id);e?e.qty++:l.items.push({product_id:r.id,title:r.title,sell_price:r.sell_price,qty:1}),m.value="",x.value=[]},S=r=>{l.items.splice(r,1)},C=P(()=>l.items.reduce((r,e)=>r+e.sell_price*e.qty,0)),j=()=>{l.put(k("product-bundles.update",i.bundle.id))},u=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r||0),k=(r,e)=>typeof window<"u"&&window.route?window.route(r,e):"#";return(r,e)=>(o(),$(z,null,{default:A(()=>[c(a(F),{title:"Edit Bundle"}),t("div",K,[t("div",L,[t("div",null,[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Edit Bundle",-1)),t("p",Q,"Edit paket bundling "+d(y.bundle.code),1)]),c(h,{type:"link",icon:a(O),class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300",label:"Kembali",href:k("product-bundles.index")},null,8,["icon","href"])])]),t("div",M,[t("div",Z,[t("div",G,[e[12]||(e[12]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Informasi Bundle",-1)),t("div",W,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Kode Bundle",-1)),b(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>a(l).code=s),type:"text",class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200"},null,512),[[p,a(l).code]]),a(l).errors.code?(o(),n("p",X,d(a(l).errors.code),1)):_("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Nama Bundle",-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a(l).name=s),type:"text",class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200"},null,512),[[p,a(l).name]]),a(l).errors.name?(o(),n("p",Y,d(a(l).errors.name),1)):_("",!0)]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Harga Jual Bundle",-1)),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a(l).sell_price=s),type:"number",min:"0",class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200"},null,512),[[p,a(l).sell_price]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Deskripsi",-1)),b(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>a(l).description=s),rows:"3",class:"w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 resize-none"},null,512),[[p,a(l).description]])]),t("div",null,[c(R,{label:"Status",data:f,selected:w.value,"set-selected":U,placeholder:"Pilih status",errors:a(l).errors.is_active},null,8,["selected","errors"])])])]),t("div",tt,[e[13]||(e[13]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Cari Produk",-1)),t("div",et,[b(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),onInput:e[5]||(e[5]=(...s)=>a(B)&&a(B)(...s)),type:"text",placeholder:"Cari produk...",class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200"},null,544),[[p,m.value]]),x.value.length>0?(o(),n("div",st,[(o(!0),n(V,null,q(x.value,s=>(o(),n("div",{key:s.id,onClick:v=>E(s),class:"p-3 hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer border-b last:border-0"},[t("p",rt,d(s.title),1),t("p",at,d(u(s.sell_price)),1)],8,lt))),128))])):_("",!0)])])]),t("div",dt,[t("div",ot,[e[19]||(e[19]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Item dalam Bundle",-1)),t("table",it,[e[15]||(e[15]=t("thead",null,[t("tr",{class:"border-b border-slate-100 dark:border-slate-700 text-left text-sm text-slate-500"},[t("th",{class:"pb-3"},"Produk"),t("th",{class:"pb-3 text-right"},"Harga"),t("th",{class:"pb-3 text-center w-24"},"Qty"),t("th",{class:"pb-3 text-right"},"Subtotal"),t("th",{class:"pb-3 w-10"})])],-1)),t("tbody",nt,[a(l).items.length===0?(o(),n("tr",ut,[...e[14]||(e[14]=[t("td",{colspan:"5",class:"py-8 text-center text-slate-500 italic text-sm"},"Belum ada item",-1)])])):_("",!0),(o(!0),n(V,null,q(a(l).items,(s,v)=>(o(),n("tr",{key:v},[t("td",ct,[t("span",bt,d(s.title),1)]),t("td",pt,d(u(s.sell_price)),1),t("td",mt,[b(t("input",{type:"number","onUpdate:modelValue":I=>s.qty=I,min:"1",class:"w-16 px-2 py-1 text-center text-sm rounded-lg border border-slate-200 bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,xt),[[p,s.qty]])]),t("td",kt,d(u(s.sell_price*s.qty)),1),t("td",_t,[t("button",{onClick:I=>S(v),class:"text-slate-400 hover:text-danger-500"},[c(a(T),{size:18})],8,ft)])]))),128))])]),t("div",vt,[t("div",gt,[e[16]||(e[16]=t("span",{class:"text-slate-600"},"Total Ecer",-1)),t("span",ht,d(u(C.value)),1)]),t("div",yt,[e[17]||(e[17]=t("span",{class:"text-slate-600"},"Harga Bundle",-1)),t("span",wt,d(u(a(l).sell_price)),1)]),t("div",Bt,[e[18]||(e[18]=t("span",{class:"text-slate-600"},"Hemat",-1)),t("span",Ct,d(u(C.value-a(l).sell_price)),1)]),t("div",It,[c(h,{type:"button",label:"Batal",class:"bg-white border border-slate-200 text-slate-700",onClick:e[6]||(e[6]=s=>a(H).visit(k("product-bundles.index")))}),c(h,{type:"submit",label:"Update Bundle",class:"bg-primary-500 hover:bg-primary-600 text-white",processing:a(l).processing,disabled:a(l).items.length===0,onClick:j},null,8,["processing","disabled"])])])])])])]),_:1}))}};export{Tt as default};
