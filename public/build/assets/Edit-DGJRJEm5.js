import{T as G,r as k,J as N,A as F,E as K,a as l,c as L,w as M,b as i,u as o,Z as Q,d as t,t as u,n as q,k as c,y as E,v as x,g as n,F as U,p as B,h as f,O as R}from"./app-CIYeQ-4j.js";import{I as W}from"./IconArrowLeft-D_cLVqwd.js";import{I as J}from"./IconSearch-_c1o4uNe.js";import{I as Z}from"./IconTrash-CUcDdroG.js";import{_ as H}from"./DashboardLayout-CDE7-Y8V.js";import{_ as y}from"./Button-CxuUSqWK.js";import{_ as X}from"./InputSelect-CCGvz5pc.js";import{l as Y}from"./lodash-Dim8PIC9.js";import"./createVueComponent-Cyzcg1Tn.js";import"./IconUsers-lhp4zDA0.js";import"./IconSun-B2kMHmLk.js";import"./IconFileInvoice-CDLMKT3Q.js";import"./IconReceipt-CzHzcLcH.js";import"./IconShoppingCart-C-7we8qa.js";import"./IconCircleFilled-CJHeZp2T.js";const tt={class:"mb-6"},et={class:"flex items-center justify-between"},st={class:"text-sm text-slate-500 dark:text-slate-400"},at={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},rt={class:"lg:col-span-1 space-y-6"},ot={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},lt={class:"space-y-3"},dt={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},it={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},nt={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},ut={class:"relative"},ct={class:"flex items-center gap-2 mb-2"},bt={key:0,class:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-xl max-h-64 overflow-y-auto"},pt=["onClick"],mt={class:"flex items-center gap-3"},xt={class:"w-10 h-10 rounded-lg bg-slate-100 dark:bg-slate-700 flex-shrink-0"},ht=["src"],gt={class:"font-medium text-slate-900 dark:text-white text-sm"},kt={class:"text-xs text-slate-500"},ft={class:"ml-auto text-right"},yt={class:"text-xs font-semibold text-slate-700 dark:text-slate-300"},wt={class:"lg:col-span-2"},vt={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6 h-full flex flex-col"},_t={class:"flex-1 overflow-x-auto"},jt={class:"w-full"},St={class:"divide-y divide-slate-100 dark:divide-slate-700"},Ct={key:0},It={class:"py-3 pl-2"},Pt={class:"flex flex-col"},Vt={class:"font-medium text-slate-900 dark:text-white text-sm"},Tt={class:"text-xs text-slate-500"},qt={class:"py-3 text-center"},Et=["onUpdate:modelValue"],Ut={class:"py-3 text-center"},Bt=["onClick"],$t={class:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-700"},Ot={class:"mb-4"},zt={class:"flex justify-end gap-3"},Yt={__name:"Edit",props:{warehouses:Array,adjustment:Object},setup(h){var _,j,S,C,I,P,V;const d=h,r=G({type:((_=d.adjustment)==null?void 0:_.type)||"in",warehouse_id:((j=d.adjustment)==null?void 0:j.warehouse_id)||"",date:((S=d.adjustment)==null?void 0:S.date)||new Date().toISOString().split("T")[0],notes:((C=d.adjustment)==null?void 0:C.notes)||"",items:((P=(I=d.adjustment)==null?void 0:I.details)==null?void 0:P.map(a=>{var e,s;return{product_id:a.product_id,title:(e=a.product)==null?void 0:e.title,barcode:(s=a.product)==null?void 0:s.barcode,qty:a.qty}}))||[]}),w=k(((V=d.adjustment)==null?void 0:V.warehouse)||null),b=k(""),p=k([]),$=a=>{w.value=a,r.warehouse_id=a?a.id:""},v=Y.debounce(async()=>{if(!b.value){p.value=[];return}try{const a=await N.post(m("stock-adjustments.searchProduct"),{q:b.value});p.value=a.data}catch(a){console.error(a)}},300),O=a=>{const e=r.items.find(s=>s.product_id===a.id);e?e.qty++:r.items.push({product_id:a.id,title:a.title,barcode:a.barcode,qty:1}),b.value="",p.value=[]},z=a=>{r.items.splice(a,1)},A=F(()=>r.items.reduce((a,e)=>a+e.buy_price*e.qty,0));K(A,a=>{r.grand_total=a});const D=()=>{r.put(m("stock-adjustments.update",d.adjustment.id))},m=(a,e)=>typeof window<"u"&&window.route?window.route(a,e):"#";return(a,e)=>(l(),L(H,null,{default:M(()=>[i(o(Q),{title:"Edit Penyesuaian Stok"}),t("div",tt,[t("div",et,[t("div",null,[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Edit Penyesuaian Stok",-1)),t("p",st," Edit penyesuaian "+u(h.adjustment.code)+". ",1)]),i(y,{type:"link",icon:o(W),class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",label:"Kembali",href:m("stock-adjustments.index")},null,8,["icon","href"])])]),t("div",at,[t("div",rt,[t("div",ot,[e[10]||(e[10]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Tipe Penyesuaian",-1)),t("div",lt,[t("label",{class:q(["flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all",o(r).type==="in"?"border-green-500 bg-green-50 dark:bg-green-950/30":"border-slate-200 dark:border-slate-700"])},[c(t("input",{type:"radio","onUpdate:modelValue":e[0]||(e[0]=s=>o(r).type=s),value:"in",class:"w-4 h-4 text-green-600"},null,512),[[E,o(r).type]]),e[8]||(e[8]=t("div",null,[t("p",{class:"font-medium text-slate-900 dark:text-white"},"Stock In"),t("p",{class:"text-xs text-slate-500"},"Tambah stok")],-1))],2),t("label",{class:q(["flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all",o(r).type==="out"?"border-red-500 bg-red-50 dark:bg-red-950/30":"border-slate-200 dark:border-slate-700"])},[c(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=s=>o(r).type=s),value:"out",class:"w-4 h-4 text-red-600"},null,512),[[E,o(r).type]]),e[9]||(e[9]=t("div",null,[t("p",{class:"font-medium text-slate-900 dark:text-white"},"Stock Out"),t("p",{class:"text-xs text-slate-500"},"Kurangi stok")],-1))],2)])]),t("div",dt,[e[11]||(e[11]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Tanggal",-1)),c(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>o(r).date=s),class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[x,o(r).date]])]),t("div",it,[e[12]||(e[12]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Gudang Tujuan",-1)),i(X,{label:"Pilih Gudang",data:h.warehouses,selected:w.value,"set-selected":$,placeholder:"Pilih Gudang...",searchable:!0,errors:o(r).errors.warehouse_id},null,8,["data","selected","errors"])]),t("div",nt,[e[13]||(e[13]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Cari Produk",-1)),t("div",ut,[t("div",ct,[i(o(J),{size:20,class:"text-slate-400"}),c(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),onInput:e[4]||(e[4]=(...s)=>o(v)&&o(v)(...s)),placeholder:"Scan barcode atau ketik nama...",class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none"},null,544),[[x,b.value]])]),p.value.length>0?(l(),n("div",bt,[(l(!0),n(U,null,B(p.value,s=>(l(),n("div",{key:s.id,onClick:g=>O(s),class:"p-3 hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer border-b border-slate-100 dark:border-slate-700 last:border-0"},[t("div",mt,[t("div",xt,[s.image?(l(),n("img",{key:0,src:s.image,class:"w-full h-full object-cover rounded-lg"},null,8,ht)):f("",!0)]),t("div",null,[t("p",gt,u(s.title),1),t("p",kt,u(s.barcode),1)]),t("div",ft,[t("p",yt,"Stok: "+u(s.stock),1)])])],8,pt))),128))])):f("",!0)])])]),t("div",wt,[t("div",vt,[e[17]||(e[17]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Daftar Item",-1)),t("div",_t,[t("table",jt,[e[15]||(e[15]=t("thead",null,[t("tr",{class:"border-b border-slate-100 dark:border-slate-700 text-left text-sm text-slate-500"},[t("th",{class:"pb-3 pl-2"},"Produk"),t("th",{class:"pb-3 text-center w-24"},"Qty"),t("th",{class:"pb-3 w-10"})])],-1)),t("tbody",St,[o(r).items.length===0?(l(),n("tr",Ct,[...e[14]||(e[14]=[t("td",{colspan:"5",class:"py-8 text-center text-slate-500 italic text-sm"}," Belum ada item dipilih ",-1)])])):f("",!0),(l(!0),n(U,null,B(o(r).items,(s,g)=>(l(),n("tr",{key:g,class:"group"},[t("td",It,[t("div",Pt,[t("span",Vt,u(s.title),1),t("span",Tt,u(s.barcode),1)])]),t("td",qt,[c(t("input",{type:"number","onUpdate:modelValue":T=>s.qty=T,min:"0",class:"w-20 px-2 py-1 text-center text-sm rounded-lg border border-slate-200 bg-slate-50 focus:border-primary-500 focus:ring-0 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,Et),[[x,s.qty]])]),t("td",Ut,[t("button",{onClick:T=>z(g),class:"text-slate-400 hover:text-danger-500 transition-colors"},[i(o(Z),{size:18})],8,Bt)])]))),128))])])]),t("div",$t,[t("div",Ot,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Catatan ",-1)),c(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>o(r).notes=s),rows:"3",placeholder:"Alasan penyesuaian stok...",class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[x,o(r).notes]])]),t("div",zt,[i(y,{type:"button",label:"Batal",class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",onClick:e[6]||(e[6]=s=>o(R).visit(m("stock-adjustments.index")))}),i(y,{type:"submit",label:"Simpan Penyesuaian",class:"bg-primary-500 hover:bg-primary-600 text-white shadow-lg shadow-primary-500/30",processing:o(r).processing,disabled:o(r).items.length===0||!o(r).warehouse_id||!o(r).type,onClick:D},null,8,["processing","disabled"])])])])])])]),_:1}))}};export{Yt as default};
