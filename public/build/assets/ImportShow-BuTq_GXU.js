import{r as N,A as C,a as f,c as P,w as s,b as t,u as g,Z as G,d as a,t as r,n as k,h as E,e as l,g as x,p as D,F as w,f as K,O as Q}from"./app-CIYeQ-4j.js";import{I as H}from"./IconArrowLeft-D_cLVqwd.js";import{a as A}from"./IconSun-B2kMHmLk.js";import{I as M}from"./IconCheck-WfpMGL5V.js";import{I as R}from"./IconEye-0DdC_4Hy.js";import{h as U,_ as W}from"./DashboardLayout-CDE7-Y8V.js";import{I as Z}from"./IconUser-CjGQ9nH3.js";import{_ as q}from"./Button-CxuUSqWK.js";import{_ as S}from"./Table-W38pwiux.js";import{_ as T}from"./TableCard-DWxSJUUQ.js";import{_ as $,a as z}from"./TableTbody-B6-z0LtQ.js";import{_ as i,a as n}from"./TableTh-C_S67pHj.js";import"./createVueComponent-Cyzcg1Tn.js";import"./IconUsers-lhp4zDA0.js";import"./IconFileInvoice-CDLMKT3Q.js";import"./IconReceipt-CzHzcLcH.js";import"./IconShoppingCart-C-7we8qa.js";const J={class:"mb-6"},X={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Y={class:"text-sm text-slate-500 dark:text-slate-400"},tt={class:"flex items-center gap-3"},et={class:"mb-6 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},st={class:"grid grid-cols-2 md:grid-cols-5 gap-6"},at={class:"text-center"},lt={class:"text-2xl font-bold text-slate-900 dark:text-white"},rt={class:"text-center"},ot={class:"text-2xl font-bold text-green-600"},nt={class:"text-center"},it={class:"text-2xl font-bold text-red-600"},dt={class:"text-center"},ut={class:"text-sm font-medium text-slate-900 dark:text-white"},ft={class:"text-center"},ct={class:"text-sm font-medium text-slate-900 dark:text-white"},xt={class:"flex items-center gap-2 text-sm"},mt={class:"font-medium text-slate-900 dark:text-white"},pt={class:"text-slate-500 text-sm"},gt={class:"flex items-center gap-2"},kt={class:"text-sm"},_t={class:"font-bold text-primary-600 dark:text-primary-400"},bt={key:0,class:"text-red-600 font-bold"},vt={key:1,class:"text-green-600 font-semibold"},yt={key:1},ht=["onClick"],wt={class:"font-bold text-slate-900 dark:text-white"},It={class:"flex items-center gap-2"},Ct={class:"flex items-center gap-2"},Dt={class:"uppercase text-xs font-semibold"},St=["onClick"],Tt={key:1},$t={class:"font-medium text-slate-900 dark:text-white"},zt={class:"text-slate-500 text-sm"},Lt={class:"bg-slate-50 dark:bg-slate-800/50"},Bt={key:1},Ft={class:"flex flex-col items-center"},Jt={__name:"ImportShow",props:{importLog:Object,salesImport:Array,stockComparison:Array},setup(m){const _=m,p=N(_.salesImport.length>0?_.salesImport[0]:null),I=N(!1),v=C(()=>_.stockComparison.filter(u=>!u.is_sufficient).length),y=C(()=>v.value===0&&_.salesImport.length>0),O=C(()=>_.salesImport.some(u=>u.status==="draft")),L=u=>{p.value=u},V=()=>{if(!y.value)return;const u=_.salesImport.filter(e=>e.status==="draft").length;confirm(`Finalize ${u} transaksi import? Stok akan dikurangi dan transaksi akan masuk ke daftar penjualan utama.`)&&(I.value=!0,Q.post(B("sales.import.finalize",_.importLog.id),{},{onFinish:()=>{I.value=!1}}))},b=u=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(u||0),j=u=>new Date(u).toLocaleString("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),B=(u,e)=>typeof window<"u"&&window.route?window.route(u,e):"#";return(u,e)=>(f(),P(W,null,{default:s(()=>{var F;return[t(g(G),{title:"Detail Import Transaksi"}),a("div",J,[a("div",X,[a("div",null,[e[0]||(e[0]=a("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Detail Import Transaksi",-1)),a("p",Y,r(m.importLog.filename),1)]),a("div",tt,[t(q,{type:"link",icon:g(H),class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",label:"Kembali",href:B("sales.index")},null,8,["icon","href"]),O.value?(f(),P(q,{key:0,type:"button",icon:g(M),class:k([y.value?"bg-green-500 hover:bg-green-600 text-white shadow-lg shadow-green-500/30":"bg-slate-300 text-slate-500 cursor-not-allowed"]),label:y.value?"Finalize Semua":"Stok Belum Siap",disabled:!y.value||I.value,onClick:V},null,8,["icon","class","label","disabled"])):E("",!0)])])]),a("div",et,[a("div",st,[a("div",at,[a("p",lt,r(m.importLog.total_rows),1),e[1]||(e[1]=a("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Total Baris",-1))]),a("div",rt,[a("p",ot,r(m.importLog.success_count),1),e[2]||(e[2]=a("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Transaksi Sukses",-1))]),a("div",nt,[a("p",it,r(m.importLog.failed_count),1),e[3]||(e[3]=a("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Baris Gagal",-1))]),a("div",dt,[a("p",ut,r(((F=m.importLog.user)==null?void 0:F.name)||"-"),1),e[4]||(e[4]=a("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Diimport Oleh",-1))]),a("div",ft,[a("p",ct,r(j(m.importLog.created_at)),1),e[5]||(e[5]=a("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Tanggal Import",-1))])])]),t(T,{title:"Perbandingan Stok Produk",class:"mb-6"},{header:s(()=>[a("div",xt,[a("span",{class:k([v.value>0?"text-red-600":"text-green-600","font-semibold"])},r(v.value>0?`${v.value} produk stok kurang`:"Semua stok mencukupi"),3)])]),default:s(()=>[t(S,null,{default:s(()=>[t($,null,{default:s(()=>[a("tr",null,[t(i,{class:"w-10"},{default:s(()=>[...e[6]||(e[6]=[l("No",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[7]||(e[7]=[l("Produk",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[8]||(e[8]=[l("Barcode",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[9]||(e[9]=[l("Gudang",-1)])]),_:1}),t(i,{class:"text-center"},{default:s(()=>[...e[10]||(e[10]=[l("Total Qty Import",-1)])]),_:1}),t(i,{class:"text-center"},{default:s(()=>[...e[11]||(e[11]=[l("Stok Tersedia",-1)])]),_:1}),t(i,{class:"text-center"},{default:s(()=>[...e[12]||(e[12]=[l("Selisih",-1)])]),_:1}),t(i,{class:"text-center"},{default:s(()=>[...e[13]||(e[13]=[l("Status",-1)])]),_:1})])]),_:1}),t(z,null,{default:s(()=>[m.stockComparison.length>0?(f(!0),x(w,{key:0},D(m.stockComparison,(o,d)=>(f(),x("tr",{key:`${o.product_id}_${o.warehouse_id}`,class:k(["transition-colors",o.is_sufficient?"hover:bg-slate-50 dark:hover:bg-slate-800/50":"bg-red-50 dark:bg-red-900/10"])},[t(n,{class:"text-center"},{default:s(()=>[l(r(d+1),1)]),_:2},1024),t(n,null,{default:s(()=>[a("span",mt,r(o.product_title),1)]),_:2},1024),t(n,null,{default:s(()=>[a("span",pt,r(o.product_barcode),1)]),_:2},1024),t(n,null,{default:s(()=>[a("div",gt,[t(g(A),{size:14,class:"text-slate-400"}),a("span",kt,r(o.warehouse_name),1)])]),_:2},1024),t(n,{class:"text-center"},{default:s(()=>[a("span",_t,r(o.total_qty),1)]),_:2},1024),t(n,{class:"text-center"},{default:s(()=>[a("span",{class:k(o.current_stock<o.total_qty?"text-red-600 font-bold":"text-slate-700 dark:text-slate-300")},r(o.current_stock),3)]),_:2},1024),t(n,{class:"text-center"},{default:s(()=>[o.shortage>0?(f(),x("span",bt," -"+r(o.shortage),1)):(f(),x("span",vt," +"+r(o.current_stock-o.total_qty),1))]),_:2},1024),t(n,{class:"text-center"},{default:s(()=>[a("span",{class:k(["px-2 py-1 rounded-full text-xs font-semibold",o.is_sufficient?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"])},r(o.is_sufficient?"Cukup":"Kurang"),3)]),_:2},1024)],2))),128)):(f(),x("tr",yt,[t(n,{colspan:"8",class:"text-center py-8 text-slate-500"},{default:s(()=>[...e[14]||(e[14]=[l(" Tidak ada data perbandingan stok ",-1)])]),_:1})]))]),_:1})]),_:1})]),_:1}),t(T,{title:"Daftar Transaksi Import",class:"mb-6"},{default:s(()=>[t(S,null,{default:s(()=>[t($,null,{default:s(()=>[a("tr",null,[t(i,{class:"w-10"},{default:s(()=>[...e[15]||(e[15]=[l("No",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[16]||(e[16]=[l("No. Invoice",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[17]||(e[17]=[l("Customer",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[18]||(e[18]=[l("Gudang",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[19]||(e[19]=[l("Pembayaran",-1)])]),_:1}),t(i,{class:"text-right"},{default:s(()=>[...e[20]||(e[20]=[l("Total",-1)])]),_:1}),t(i,{class:"text-center"},{default:s(()=>[...e[21]||(e[21]=[l("Status",-1)])]),_:1}),t(i,{class:"text-center"},{default:s(()=>[...e[22]||(e[22]=[l("Aksi",-1)])]),_:1})])]),_:1}),t(z,null,{default:s(()=>[m.salesImport.length>0?(f(!0),x(w,{key:0},D(m.salesImport,(o,d)=>{var h;return f(),x("tr",{key:o.id,class:k(["hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors cursor-pointer",((h=p.value)==null?void 0:h.id)===o.id?"bg-primary-50 dark:bg-primary-900/20":""]),onClick:c=>L(o)},[t(n,{class:"text-center"},{default:s(()=>[l(r(d+1),1)]),_:2},1024),t(n,null,{default:s(()=>[a("span",wt,r(o.invoice),1)]),_:2},1024),t(n,null,{default:s(()=>{var c;return[a("div",It,[t(g(Z),{size:16,class:"text-slate-400"}),a("span",null,r(((c=o.customer)==null?void 0:c.name)||"-"),1)])]}),_:2},1024),t(n,null,{default:s(()=>{var c;return[a("div",Ct,[t(g(A),{size:16,class:"text-slate-400"}),a("span",null,r(((c=o.warehouse)==null?void 0:c.name)||"-"),1)])]}),_:2},1024),t(n,null,{default:s(()=>[a("span",Dt,r(o.payment_type),1)]),_:2},1024),t(n,{class:"text-right font-bold text-slate-900 dark:text-white"},{default:s(()=>[l(r(b(o.grand_total)),1)]),_:2},1024),t(n,{class:"text-center"},{default:s(()=>[a("span",{class:k(["px-2 py-1 rounded-full text-xs font-semibold",o.status==="finalized"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"])},r(o.status==="finalized"?"Finalized":"Draft"),3)]),_:2},1024),t(n,{class:"text-center"},{default:s(()=>[a("button",{onClick:K(c=>L(o),["stop"]),class:"p-1.5 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 text-blue-600 dark:text-blue-400 transition-colors",title:"Lihat Detail"},[t(g(R),{size:18})],8,St)]),_:2},1024)],10,ht)}),128)):(f(),x("tr",Tt,[t(n,{colspan:"8",class:"text-center py-8 text-slate-500"},{default:s(()=>[...e[23]||(e[23]=[l(" Tidak ada transaksi import ",-1)])]),_:1})]))]),_:1})]),_:1})]),_:1}),t(T,{title:p.value?`Detail Item - ${p.value.invoice}`:"Detail Item (Pilih transaksi di atas)"},{default:s(()=>[t(S,null,{default:s(()=>[t($,null,{default:s(()=>[a("tr",null,[t(i,{class:"w-10"},{default:s(()=>[...e[24]||(e[24]=[l("No",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[25]||(e[25]=[l("Produk",-1)])]),_:1}),t(i,null,{default:s(()=>[...e[26]||(e[26]=[l("Barcode",-1)])]),_:1}),t(i,{class:"text-right"},{default:s(()=>[...e[27]||(e[27]=[l("Harga",-1)])]),_:1}),t(i,{class:"text-center"},{default:s(()=>[...e[28]||(e[28]=[l("Qty",-1)])]),_:1}),t(i,{class:"text-right"},{default:s(()=>[...e[29]||(e[29]=[l("Diskon",-1)])]),_:1}),t(i,{class:"text-right"},{default:s(()=>[...e[30]||(e[30]=[l("Subtotal",-1)])]),_:1})])]),_:1}),t(z,null,{default:s(()=>{var o;return[p.value&&((o=p.value.details)==null?void 0:o.length)>0?(f(),x(w,{key:0},[(f(!0),x(w,null,D(p.value.details,(d,h)=>(f(),x("tr",{key:d.id,class:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors"},[t(n,{class:"text-center"},{default:s(()=>[l(r(h+1),1)]),_:2},1024),t(n,null,{default:s(()=>{var c;return[a("span",$t,r(((c=d.product)==null?void 0:c.title)||"-"),1)]}),_:2},1024),t(n,null,{default:s(()=>{var c;return[a("span",zt,r(((c=d.product)==null?void 0:c.barcode)||"-"),1)]}),_:2},1024),t(n,{class:"text-right"},{default:s(()=>[l(r(b(d.sell_price)),1)]),_:2},1024),t(n,{class:"text-center font-medium"},{default:s(()=>[l(r(d.qty),1)]),_:2},1024),t(n,{class:"text-right"},{default:s(()=>[a("span",{class:k(d.discount>0?"text-red-500":"text-slate-400")},r(d.discount>0?"-"+b(d.discount):"-"),3)]),_:2},1024),t(n,{class:"text-right font-bold text-slate-900 dark:text-white"},{default:s(()=>[l(r(b(d.sell_price*d.qty-d.discount)),1)]),_:2},1024)]))),128)),a("tr",Lt,[t(n,{colspan:"6",class:"text-right font-bold text-slate-600 dark:text-slate-400"},{default:s(()=>[...e[31]||(e[31]=[l(" TOTAL ",-1)])]),_:1}),t(n,{class:"text-right font-black text-primary-600 dark:text-primary-400 text-lg"},{default:s(()=>[l(r(b(p.value.grand_total)),1)]),_:1})])],64)):(f(),x("tr",Bt,[t(n,{colspan:"7",class:"text-center py-8 text-slate-500"},{default:s(()=>[a("div",Ft,[t(g(U),{size:32,class:"text-slate-300 mb-2"}),a("p",null,r(p.value?"Tidak ada item":"Pilih transaksi untuk melihat detail item"),1)])]),_:1})]))]}),_:1})]),_:1})]),_:1},8,["title"])]}),_:1}))}};export{Jt as default};
