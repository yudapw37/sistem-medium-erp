import{T as B,r as h,A as I,a as d,c as T,w as D,b as n,u as a,Z as L,d as t,k as x,v as m,g as i,t as l,h as y,e as g,p as O,n as F,F as N,O as U,J as A}from"./app-CIYeQ-4j.js";import{I as G}from"./IconArrowLeft-D_cLVqwd.js";import{I as W}from"./IconSearch-_c1o4uNe.js";import{_ as $}from"./DashboardLayout-CDE7-Y8V.js";import{_ as f}from"./Button-CxuUSqWK.js";import{_ as j}from"./InputSelect-CCGvz5pc.js";import"./createVueComponent-Cyzcg1Tn.js";import"./IconUsers-lhp4zDA0.js";import"./IconSun-B2kMHmLk.js";import"./IconFileInvoice-CDLMKT3Q.js";import"./IconReceipt-CzHzcLcH.js";import"./IconShoppingCart-C-7we8qa.js";import"./IconCircleFilled-CJHeZp2T.js";const z={class:"mb-6"},M={class:"flex items-center justify-between"},K={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},E={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},J={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},Z={key:0,class:"text-xs text-amber-600 dark:text-amber-400 mt-2"},q={key:1,class:"text-xs text-blue-600 dark:text-blue-400 mt-2"},H={key:2,class:"text-xs text-green-600 dark:text-green-400 mt-2"},Q={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},R={class:"relative"},X={class:"flex items-center gap-2"},Y=["disabled"],tt={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},et={class:"text-sm"},st={class:"text-slate-600 dark:text-slate-400"},at={class:"font-bold text-slate-900 dark:text-white"},rt={class:"text-slate-600 dark:text-slate-400"},ot={class:"font-bold text-slate-900 dark:text-white"},lt={class:"flex flex-row gap-6"},dt={style:{width:"75%"}},it={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},nt={class:"overflow-x-auto"},ct={class:"w-full"},ut={class:"divide-y divide-slate-100 dark:divide-slate-700"},bt={key:0},pt={key:1},xt={key:2},mt={class:"py-3 pl-2 text-slate-600 dark:text-slate-400"},kt={class:"py-3"},ht={class:"flex flex-col"},gt={class:"font-medium text-slate-900 dark:text-white text-sm"},ft={class:"text-xs text-slate-500"},_t={class:"py-3"},wt={class:"text-xs text-slate-600 dark:text-slate-400"},yt={class:"py-3 text-center"},vt={class:"px-3 py-1 bg-slate-100 dark:bg-slate-800 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300"},Ct={class:"py-3 text-center"},St=["onUpdate:modelValue"],Pt={class:"py-3 text-center"},Vt={style:{width:"25%"}},Bt={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6 h-full flex flex-col"},It={class:"flex-1 mb-4"},Tt={class:"space-y-3"},Kt={__name:"Create",props:{warehouses:Array},setup(v){const s=B({warehouse_id:"",date:new Date().toISOString().split("T")[0],notes:"",items:[]}),_=h(null),c=h(!1),u=h(""),k=I(()=>{if(!u.value)return s.items;const r=u.value.toLowerCase();return s.items.filter(e=>e.title.toLowerCase().includes(r)||e.barcode.toLowerCase().includes(r)||e.category&&e.category.toLowerCase().includes(r))}),C=async r=>{_.value=r,s.warehouse_id=r?r.id:"",s.warehouse_id?await S():s.items=[]},S=async()=>{c.value=!0;try{const r=await A.post(p("stock-opnames.getWarehouseProducts"),{warehouse_id:s.warehouse_id});s.items=r.data}catch(r){console.error(r),alert("Gagal memuat produk")}finally{c.value=!1}},b=r=>(r.physical_stock||0)-(r.system_stock||0),P=()=>{s.post(p("stock-opnames.store"))},p=(r,e)=>typeof window<"u"&&window.route?window.route(r,e):"#";return(r,e)=>(d(),T($,null,{default:D(()=>[n(a(L),{title:"Stock Opname Baru"}),t("div",z,[t("div",M,[e[4]||(e[4]=t("div",null,[t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Stock Opname Baru"),t("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Buat penghitungan fisik stok gudang. ")],-1)),n(f,{type:"link",icon:a(G),class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",label:"Kembali",href:p("stock-opnames.index")},null,8,["icon","href"])])]),t("div",K,[t("div",E,[e[5]||(e[5]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Tanggal",-1)),x(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=o=>a(s).date=o),class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[m,a(s).date]])]),t("div",J,[e[6]||(e[6]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Gudang",-1)),n(j,{label:"Pilih Gudang",data:v.warehouses,selected:_.value,"set-selected":C,placeholder:"Pilih Gudang...",searchable:!0,errors:a(s).errors.warehouse_id},null,8,["data","selected","errors"]),a(s).warehouse_id?c.value?(d(),i("p",q," Memuat produk... ")):a(s).items.length>0?(d(),i("p",H," âœ“ "+l(a(s).items.length)+" produk dimuat ",1)):y("",!0):(d(),i("p",Z," Pilih gudang untuk memuat semua produk "))]),t("div",Q,[e[7]||(e[7]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Filter Produk",-1)),t("div",R,[t("div",X,[n(a(W),{size:20,class:"text-slate-400"}),x(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>u.value=o),placeholder:"Cari produk...",disabled:a(s).items.length===0,class:"w-full h-10 px-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none disabled:opacity-50"},null,8,Y),[[m,u.value]])])])]),t("div",tt,[e[10]||(e[10]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Informasi",-1)),t("div",et,[t("p",st,[e[8]||(e[8]=g("Total Produk: ",-1)),t("span",at,l(a(s).items.length),1)]),t("p",rt,[e[9]||(e[9]=g("Ditampilkan: ",-1)),t("span",ot,l(k.value.length),1)])])])]),t("div",lt,[t("div",dt,[t("div",it,[e[15]||(e[15]=t("div",{class:"flex items-center justify-between mb-4"},[t("h3",{class:"font-semibold text-slate-900 dark:text-white"},"Daftar Produk")],-1)),t("div",nt,[t("table",ct,[e[14]||(e[14]=t("thead",null,[t("tr",{class:"border-b border-slate-100 dark:border-slate-700 text-left text-sm text-slate-500"},[t("th",{class:"pb-3 pl-2 w-12"},"No"),t("th",{class:"pb-3"},"Produk"),t("th",{class:"pb-3"},"Kategori"),t("th",{class:"pb-3 text-center w-32"},"Stok Sistem"),t("th",{class:"pb-3 text-center w-32"},"Stok Fisik"),t("th",{class:"pb-3 text-center w-32"},"Selisih")])],-1)),t("tbody",ut,[a(s).warehouse_id?c.value?(d(),i("tr",pt,[...e[12]||(e[12]=[t("td",{colspan:"6",class:"py-8 text-center text-slate-500 italic text-sm"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-5 h-5 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"}),g(" Memuat produk... ")])],-1)])])):k.value.length===0?(d(),i("tr",xt,[...e[13]||(e[13]=[t("td",{colspan:"6",class:"py-8 text-center text-slate-500 italic text-sm"}," Tidak ada produk yang sesuai dengan pencarian ",-1)])])):y("",!0):(d(),i("tr",bt,[...e[11]||(e[11]=[t("td",{colspan:"6",class:"py-8 text-center text-slate-500 italic text-sm"}," Pilih gudang untuk memuat produk ",-1)])])),(d(!0),i(N,null,O(k.value,(o,w)=>(d(),i("tr",{key:w,class:"group hover:bg-slate-50 dark:hover:bg-slate-800/50"},[t("td",mt,l(w+1),1),t("td",kt,[t("div",ht,[t("span",gt,l(o.title),1),t("span",ft,l(o.barcode),1)])]),t("td",_t,[t("span",wt,l(o.category||"-"),1)]),t("td",yt,[t("span",vt,l(o.system_stock),1)]),t("td",Ct,[x(t("input",{type:"number","onUpdate:modelValue":V=>o.physical_stock=V,min:"0",class:"w-24 px-2 py-1 text-center text-sm rounded-lg border border-slate-200 bg-slate-50 focus:border-primary-500 focus:ring-0 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,St),[[m,o.physical_stock,void 0,{number:!0}]])]),t("td",Pt,[t("span",{class:F(["px-3 py-1 rounded-lg text-sm font-semibold",b(o)>0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":b(o)<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300"])},l(b(o)>0?"+":"")+l(b(o)),3)])]))),128))])])])])]),t("div",Vt,[t("div",Bt,[e[17]||(e[17]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Catatan & Aksi",-1)),t("div",It,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Catatan ",-1)),x(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>a(s).notes=o),rows:"10",placeholder:"Catatan stock opname...",class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"},null,512),[[m,a(s).notes]])]),t("div",Tt,[n(f,{type:"submit",label:"Simpan Stock Opname",class:"w-full bg-primary-500 hover:bg-primary-600 text-white shadow-lg shadow-primary-500/30",processing:a(s).processing,disabled:a(s).items.length===0||!a(s).warehouse_id||c.value,onClick:P},null,8,["processing","disabled"]),n(f,{type:"button",label:"Batal",class:"w-full bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",onClick:e[3]||(e[3]=o=>a(U).visit(p("stock-opnames.index")))})])])])])]),_:1}))}};export{Kt as default};
