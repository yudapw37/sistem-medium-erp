import{T as j,r as h,J as z,A,E as F,a as d,c as N,w as E,b as i,u as l,Z as G,d as e,g as n,t as o,h as k,k as u,y as I,v as _,F as P,p as V,O as R}from"./app-CIYeQ-4j.js";import{I as L}from"./IconArrowLeft-D_cLVqwd.js";import{I as M}from"./IconSearch-_c1o4uNe.js";import{I as O}from"./IconTrash-CUcDdroG.js";import{_ as Q}from"./DashboardLayout-CDE7-Y8V.js";import{_ as f}from"./Button-CxuUSqWK.js";import{_ as B}from"./InputSelect-CCGvz5pc.js";import{l as W}from"./lodash-Dim8PIC9.js";import"./createVueComponent-Cyzcg1Tn.js";import"./IconUsers-lhp4zDA0.js";import"./IconSun-B2kMHmLk.js";import"./IconFileInvoice-CDLMKT3Q.js";import"./IconReceipt-CzHzcLcH.js";import"./IconShoppingCart-C-7we8qa.js";import"./IconCircleFilled-CJHeZp2T.js";const H={class:"mb-6"},J={class:"flex items-center justify-between"},K={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Z={class:"lg:col-span-1 space-y-6"},X={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},Y={class:"space-y-4"},ee={key:0,class:"p-4 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700"},te={class:"font-medium text-slate-900 dark:text-white"},se={class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},re={class:"text-sm text-slate-500 dark:text-slate-400"},ae={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},le={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},oe={class:"flex gap-4"},de={class:"flex-1 cursor-pointer"},ie={class:"flex-1 cursor-pointer"},ne={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},ce={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},ue={class:"relative"},pe={class:"flex items-center gap-2 mb-2"},be={key:0,class:"absolute z-10 w-full mt-1 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-xl max-h-64 overflow-y-auto"},me=["onClick"],xe={class:"flex items-center gap-3"},he={class:"w-10 h-10 rounded-lg bg-slate-100 dark:bg-slate-700 flex-shrink-0"},ke=["src"],_e={class:"font-medium text-slate-900 dark:text-white text-sm"},ge={class:"text-xs text-slate-500"},fe={class:"ml-auto text-right"},ye={class:"text-xs font-semibold text-slate-700 dark:text-slate-300"},ve={class:"lg:col-span-2"},we={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6 h-full flex flex-col"},Se={class:"flex-1 overflow-x-auto"},Ce={class:"w-full"},Ie={class:"divide-y divide-slate-100 dark:divide-slate-700"},Pe={key:0},Ve={class:"py-3 pl-2"},Be={class:"flex flex-col"},Te={class:"font-medium text-slate-900 dark:text-white text-sm"},Ue={class:"text-xs text-slate-500"},qe={class:"py-3 text-right"},De=["onUpdate:modelValue"],$e={class:"py-3 text-center"},je=["onUpdate:modelValue"],ze={class:"py-3 text-right font-medium text-slate-900 dark:text-white text-sm"},Ae={class:"py-3 text-center"},Fe=["onClick"],Ne={class:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-700"},Ee={class:"flex justify-between items-center mb-6"},Ge={class:"text-2xl font-bold text-primary-600 dark:text-primary-400"},Re={class:"flex justify-end gap-3"},at={__name:"Create",props:{suppliers:Array,warehouses:Array},setup(y){const a=j({supplier_id:"",warehouse_id:"",grand_total:0,payment_type:"cash",notes:"",items:[]}),c=h(null),v=h(null),p=h(""),b=h([]),T=r=>{c.value=r,a.supplier_id=r?r.id:""},U=r=>{v.value=r,a.warehouse_id=r?r.id:""},w=W.debounce(async()=>{if(!p.value){b.value=[];return}try{const r=await z.post(m("purchases.searchProduct"),{q:p.value});b.value=r.data}catch(r){console.error(r)}},300),q=r=>{const t=a.items.find(s=>s.product_id===r.id);t?t.qty++:a.items.push({product_id:r.id,title:r.title,barcode:r.barcode,buy_price:r.buy_price,qty:1}),p.value="",b.value=[]},D=r=>{a.items.splice(r,1)},S=A(()=>a.items.reduce((r,t)=>r+t.buy_price*t.qty,0));F(S,r=>{a.grand_total=r});const $=()=>{a.post(m("purchases.store"))},C=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r||0),m=(r,t)=>typeof window<"u"&&window.route?window.route(r,t):"#";return(r,t)=>(d(),N(Q,null,{default:E(()=>[i(l(G),{title:"Pembelian Baru"}),e("div",H,[e("div",J,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Pembelian Baru"),e("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Buat transaksi pembelian stok baru. ")],-1)),i(f,{type:"link",icon:l(L),class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",label:"Kembali",href:m("purchases.index")},null,8,["icon","href"])])]),e("div",K,[e("div",Z,[e("div",X,[t[7]||(t[7]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Informasi Supplier",-1)),e("div",Y,[i(B,{label:"Pilih Supplier",data:y.suppliers,selected:c.value,"set-selected":T,placeholder:"Pilih Supplier...",searchable:!0,errors:l(a).errors.supplier_id},null,8,["data","selected","errors"]),c.value?(d(),n("div",ee,[e("p",te,o(c.value.name),1),e("p",se,o(c.value.address||"-"),1),e("p",re,o(c.value.phone||"-"),1)])):k("",!0)])]),e("div",ae,[t[8]||(t[8]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Gudang Tujuan",-1)),i(B,{label:"Pilih Gudang",data:y.warehouses,selected:v.value,"set-selected":U,placeholder:"Pilih Gudang...",searchable:!0,errors:l(a).errors.warehouse_id},null,8,["data","selected","errors"])]),e("div",le,[t[11]||(t[11]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Tipe Pembayaran",-1)),e("div",oe,[e("label",de,[u(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=s=>l(a).payment_type=s),value:"cash",class:"hidden peer"},null,512),[[I,l(a).payment_type]]),t[9]||(t[9]=e("div",{class:"p-3 text-center rounded-xl border border-slate-200 dark:border-slate-700 peer-checked:border-primary-500 peer-checked:bg-primary-50 dark:peer-checked:bg-primary-500/10 peer-checked:text-primary-600 transition-all font-medium text-sm"}," Tunai ",-1))]),e("label",ie,[u(e("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=s=>l(a).payment_type=s),value:"tempo",class:"hidden peer"},null,512),[[I,l(a).payment_type]]),t[10]||(t[10]=e("div",{class:"p-3 text-center rounded-xl border border-slate-200 dark:border-slate-700 peer-checked:border-amber-500 peer-checked:bg-amber-50 dark:peer-checked:bg-amber-500/10 peer-checked:text-amber-600 transition-all font-medium text-sm"}," Tempo ",-1))])])]),e("div",ne,[t[12]||(t[12]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Catatan",-1)),u(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>l(a).notes=s),placeholder:"Catatan/keterangan (opsional)",class:"w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none resize-none",rows:"3"},null,512),[[_,l(a).notes]])]),e("div",ce,[t[13]||(t[13]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Cari Produk",-1)),e("div",ue,[e("div",pe,[i(l(M),{size:20,class:"text-slate-400"}),u(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),onInput:t[4]||(t[4]=(...s)=>l(w)&&l(w)(...s)),placeholder:"Scan barcode atau ketik nama...",class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none"},null,544),[[_,p.value]])]),b.value.length>0?(d(),n("div",be,[(d(!0),n(P,null,V(b.value,s=>(d(),n("div",{key:s.id,onClick:g=>q(s),class:"p-3 hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer border-b border-slate-100 dark:border-slate-700 last:border-0"},[e("div",xe,[e("div",he,[s.image?(d(),n("img",{key:0,src:s.image,class:"w-full h-full object-cover rounded-lg"},null,8,ke)):k("",!0)]),e("div",null,[e("p",_e,o(s.title),1),e("p",ge,o(s.barcode),1)]),e("div",fe,[e("p",ye,"Stok: "+o(s.stock),1)])])],8,me))),128))])):k("",!0)])])]),e("div",ve,[e("div",we,[t[17]||(t[17]=e("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Daftar Item",-1)),e("div",Se,[e("table",Ce,[t[15]||(t[15]=e("thead",null,[e("tr",{class:"border-b border-slate-100 dark:border-slate-700 text-left text-sm text-slate-500"},[e("th",{class:"pb-3 pl-2"},"Produk"),e("th",{class:"pb-3 text-right"},"Harga Beli"),e("th",{class:"pb-3 text-center w-24"},"Qty"),e("th",{class:"pb-3 text-right"},"Subtotal"),e("th",{class:"pb-3 w-10"})])],-1)),e("tbody",Ie,[l(a).items.length===0?(d(),n("tr",Pe,[...t[14]||(t[14]=[e("td",{colspan:"5",class:"py-8 text-center text-slate-500 italic text-sm"}," Belum ada item dipilih ",-1)])])):k("",!0),(d(!0),n(P,null,V(l(a).items,(s,g)=>(d(),n("tr",{key:g,class:"group"},[e("td",Ve,[e("div",Be,[e("span",Te,o(s.title),1),e("span",Ue,o(s.barcode),1)])]),e("td",qe,[u(e("input",{type:"number","onUpdate:modelValue":x=>s.buy_price=x,min:"0",class:"w-32 px-2 py-1 text-right text-sm rounded-lg border border-slate-200 bg-slate-50 focus:border-primary-500 focus:ring-0 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,De),[[_,s.buy_price]])]),e("td",$e,[u(e("input",{type:"number","onUpdate:modelValue":x=>s.qty=x,min:"0",class:"w-20 px-2 py-1 text-center text-sm rounded-lg border border-slate-200 bg-slate-50 focus:border-primary-500 focus:ring-0 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,je),[[_,s.qty]])]),e("td",ze,o(C(s.buy_price*s.qty)),1),e("td",Ae,[e("button",{onClick:x=>D(g),class:"text-slate-400 hover:text-danger-500 transition-colors"},[i(l(O),{size:18})],8,Fe)])]))),128))])])]),e("div",Ne,[e("div",Ee,[t[16]||(t[16]=e("span",{class:"text-lg font-bold text-slate-700 dark:text-slate-300"},"Total Pembelian",-1)),e("span",Ge,o(C(S.value)),1)]),e("div",Re,[i(f,{type:"button",label:"Batal",class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",onClick:t[5]||(t[5]=s=>l(R).visit(m("purchases.index")))}),i(f,{type:"submit",label:"Simpan Transaksi",class:"bg-primary-500 hover:bg-primary-600 text-white shadow-lg shadow-primary-500/30",processing:l(a).processing,disabled:l(a).items.length===0||!l(a).supplier_id||!l(a).warehouse_id,onClick:$},null,8,["processing","disabled"])])])])])])]),_:1}))}};export{at as default};
