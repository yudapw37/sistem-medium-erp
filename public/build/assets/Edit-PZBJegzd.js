import{T as I,r as _,A as L,C as O,J as T,a as i,c as U,w as B,b as n,u as o,Z as D,d as t,t as l,k as m,v as h,g as c,h as S,e as w,p as F,n as N,F as j,O as A}from"./app-DA0EYa_6.js";import{I as G}from"./IconArrowLeft-gRB0gwWT.js";import{I as M}from"./IconSearch-hVNvfgeb.js";import{_ as W}from"./DashboardLayout-DqHF1oae.js";import{_ as y}from"./Button-mcRGNCmf.js";import{_ as $}from"./InputSelect-BqzyB0VS.js";import"./createVueComponent-CUBUAVU4.js";import"./IconUsers-CzMPbSiM.js";import"./IconSun-9pmbsCzq.js";import"./IconFileInvoice-DqQY055S.js";import"./IconReceipt-DjQT6mN-.js";import"./IconShoppingCart-qle56F5S.js";import"./IconCircleFilled-C8aRf-1y.js";const z={class:"mb-6"},K={class:"flex items-center justify-between"},J={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},Z={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},q={class:"text-lg font-bold text-primary-600 dark:text-primary-400"},H={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},Q={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},R={key:0,class:"text-xs text-blue-600 dark:text-blue-400 mt-2"},X={key:1,class:"text-xs text-green-600 dark:text-green-400 mt-2"},Y={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},tt={class:"relative"},et={class:"flex items-center gap-2"},st=["disabled"],at={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-4"},rt={class:"text-sm"},ot={class:"text-slate-600 dark:text-slate-400"},lt={class:"font-bold text-slate-900 dark:text-white"},dt={class:"text-slate-600 dark:text-slate-400"},it={class:"font-bold text-slate-900 dark:text-white"},nt={class:"flex flex-row gap-6"},ct={style:{width:"75%"}},ut={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6"},bt={class:"overflow-x-auto"},pt={class:"w-full"},xt={class:"divide-y divide-slate-100 dark:divide-slate-700"},mt={key:0},ht={key:1},kt={class:"py-3 pl-2 text-slate-600 dark:text-slate-400"},gt={class:"py-3"},ft={class:"flex flex-col"},_t={class:"font-medium text-slate-900 dark:text-white text-sm"},wt={class:"text-xs text-slate-500"},yt={class:"py-3"},vt={class:"text-xs text-slate-600 dark:text-slate-400"},Ct={class:"py-3 text-center"},St={class:"px-3 py-1 bg-slate-100 dark:bg-slate-800 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300"},Vt={class:"py-3 text-center"},Pt=["onUpdate:modelValue"],Et={class:"py-3 text-center"},It={style:{width:"25%"}},Lt={class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-6 h-full flex flex-col"},Ot={class:"flex-1 mb-4"},Tt={class:"space-y-3"},Jt={__name:"Edit",props:{opname:Object,warehouses:Array},setup(k){const d=k,a=I({warehouse_id:d.opname.warehouse_id,date:d.opname.date,notes:d.opname.notes||"",items:[]}),g=_(null),u=_(!1),b=_(""),f=L(()=>{if(!b.value)return a.items;const s=b.value.toLowerCase();return a.items.filter(e=>e.title.toLowerCase().includes(s)||e.barcode.toLowerCase().includes(s)||e.category&&e.category.toLowerCase().includes(s))});O(async()=>{g.value=d.warehouses.find(s=>s.id===d.opname.warehouse_id),await v(),d.opname.details.forEach(s=>{const e=a.items.find(r=>r.product_id===s.product_id);e&&(e.physical_stock=s.physical_stock)})});const V=async s=>{g.value=s,a.warehouse_id=s?s.id:"",a.warehouse_id?await v():a.items=[]},v=async()=>{u.value=!0;try{const s=await T.post(x("stock-opnames.getWarehouseProducts"),{warehouse_id:a.warehouse_id});a.items=s.data}catch(s){console.error(s),alert("Gagal memuat produk")}finally{u.value=!1}},p=s=>(s.physical_stock||0)-(s.system_stock||0),P=()=>{a.put(x("stock-opnames.update",d.opname.id))},x=(s,e)=>typeof window<"u"&&window.route?window.route(s,e):"#";return(s,e)=>(i(),U(W,null,{default:B(()=>[n(o(D),{title:"Edit Stock Opname"}),t("div",z,[t("div",K,[e[4]||(e[4]=t("div",null,[t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Edit Stock Opname"),t("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Edit penghitungan fisik stok gudang. ")],-1)),n(y,{type:"link",icon:o(G),class:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",label:"Kembali",href:x("stock-opnames.index")},null,8,["icon","href"])])]),t("div",J,[t("div",Z,[e[5]||(e[5]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-2 text-sm"},"Kode",-1)),t("p",q,l(k.opname.code),1)]),t("div",H,[e[6]||(e[6]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Tanggal",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=r=>o(a).date=r),class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[h,o(a).date]])]),t("div",Q,[e[7]||(e[7]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Gudang",-1)),n($,{label:"Pilih Gudang",data:k.warehouses,selected:g.value,"set-selected":V,placeholder:"Pilih Gudang...",searchable:!0,errors:o(a).errors.warehouse_id},null,8,["data","selected","errors"]),u.value?(i(),c("p",R," Memuat produk... ")):o(a).items.length>0?(i(),c("p",X," âœ“ "+l(o(a).items.length)+" produk dimuat ",1)):S("",!0)]),t("div",Y,[e[8]||(e[8]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Filter Produk",-1)),t("div",tt,[t("div",et,[n(o(M),{size:20,class:"text-slate-400"}),m(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=r=>b.value=r),placeholder:"Cari produk...",disabled:o(a).items.length===0,class:"w-full h-10 px-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none disabled:opacity-50"},null,8,st),[[h,b.value]])])])]),t("div",at,[e[11]||(e[11]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-3 text-sm"},"Informasi",-1)),t("div",rt,[t("p",ot,[e[9]||(e[9]=w("Total Produk: ",-1)),t("span",lt,l(o(a).items.length),1)]),t("p",dt,[e[10]||(e[10]=w("Ditampilkan: ",-1)),t("span",it,l(f.value.length),1)])])])]),t("div",nt,[t("div",ct,[t("div",ut,[e[15]||(e[15]=t("div",{class:"flex items-center justify-between mb-4"},[t("h3",{class:"font-semibold text-slate-900 dark:text-white"},"Daftar Produk")],-1)),t("div",bt,[t("table",pt,[e[14]||(e[14]=t("thead",null,[t("tr",{class:"border-b border-slate-100 dark:border-slate-700 text-left text-sm text-slate-500"},[t("th",{class:"pb-3 pl-2 w-12"},"No"),t("th",{class:"pb-3"},"Produk"),t("th",{class:"pb-3"},"Kategori"),t("th",{class:"pb-3 text-center w-32"},"Stok Sistem"),t("th",{class:"pb-3 text-center w-32"},"Stok Fisik"),t("th",{class:"pb-3 text-center w-32"},"Selisih")])],-1)),t("tbody",xt,[u.value?(i(),c("tr",mt,[...e[12]||(e[12]=[t("td",{colspan:"6",class:"py-8 text-center text-slate-500 italic text-sm"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-5 h-5 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"}),w(" Memuat produk... ")])],-1)])])):f.value.length===0?(i(),c("tr",ht,[...e[13]||(e[13]=[t("td",{colspan:"6",class:"py-8 text-center text-slate-500 italic text-sm"}," Tidak ada produk yang sesuai dengan pencarian ",-1)])])):S("",!0),(i(!0),c(j,null,F(f.value,(r,C)=>(i(),c("tr",{key:C,class:"group hover:bg-slate-50 dark:hover:bg-slate-800/50"},[t("td",kt,l(C+1),1),t("td",gt,[t("div",ft,[t("span",_t,l(r.title),1),t("span",wt,l(r.barcode),1)])]),t("td",yt,[t("span",vt,l(r.category||"-"),1)]),t("td",Ct,[t("span",St,l(r.system_stock),1)]),t("td",Vt,[m(t("input",{type:"number","onUpdate:modelValue":E=>r.physical_stock=E,min:"0",class:"w-24 px-2 py-1 text-center text-sm rounded-lg border border-slate-200 bg-slate-50 focus:border-primary-500 focus:ring-0 dark:bg-slate-800 dark:border-slate-700 dark:text-white"},null,8,Pt),[[h,r.physical_stock,void 0,{number:!0}]])]),t("td",Et,[t("span",{class:N(["px-3 py-1 rounded-lg text-sm font-semibold",p(r)>0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":p(r)<0?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300"])},l(p(r)>0?"+":"")+l(p(r)),3)])]))),128))])])])])]),t("div",It,[t("div",Lt,[e[17]||(e[17]=t("h3",{class:"font-semibold text-slate-900 dark:text-white mb-4"},"Catatan & Aksi",-1)),t("div",Ot,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Catatan ",-1)),m(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=r=>o(a).notes=r),rows:"10",placeholder:"Catatan stock opname...",class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"},null,512),[[h,o(a).notes]])]),t("div",Tt,[n(y,{type:"submit",label:"Update Stock Opname",class:"w-full bg-primary-500 hover:bg-primary-600 text-white shadow-lg shadow-primary-500/30",processing:o(a).processing,disabled:o(a).items.length===0||!o(a).warehouse_id||u.value,onClick:P},null,8,["processing","disabled"]),n(y,{type:"button",label:"Batal",class:"w-full bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",onClick:e[3]||(e[3]=r=>o(A).visit(x("stock-opnames.index")))})])])])])]),_:1}))}};export{Jt as default};
