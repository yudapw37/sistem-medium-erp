import{r as S,E as G,A as b,a as d,c as j,w as l,b as r,u as v,Z as H,d as s,e as o,n as J,g as u,h as _,p as M,F as z,f as Q,k as D,v as F,t as m,O}from"./app-DA0EYa_6.js";import{I as K}from"./IconCoin-qlLQaaAp.js";import{I as W}from"./IconDatabaseOff-DfZH0otJ.js";import{I as Y}from"./IconFilter-f3eGT3XC.js";import{c as tt}from"./createVueComponent-CUBUAVU4.js";import{I as et}from"./IconReceipt-DjQT6mN-.js";import{I as at}from"./IconSearch-hVNvfgeb.js";import{I as st}from"./IconTrendingUp-D79oSU31.js";import{I as rt}from"./IconX-JXYWA-GE.js";import{_ as lt}from"./DashboardLayout-DqHF1oae.js";import{_ as B}from"./InputSelect-BqzyB0VS.js";import{_ as c,a as p}from"./TableTh-CVR3I-fd.js";import{_ as ot}from"./Pagination-B8BHcZ6z.js";import{_ as it}from"./SummaryCard-BPONpo-Z.js";import"./IconUsers-CzMPbSiM.js";import"./IconSun-9pmbsCzq.js";import"./IconFileInvoice-DqQY055S.js";import"./IconShoppingCart-qle56F5S.js";import"./IconCircleFilled-C8aRf-1y.js";import"./IconChevronRight-QKrPJlsB.js";/**
 * @license @tabler/icons-vue v3.36.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var nt=tt("outline","percentage","Percentage",[["path",{d:"M17 17m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M7 7m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M6 18l12 -12",key:"svg-2"}]]);const dt={class:"space-y-6"},ut={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},mt={class:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2"},ct={key:0,class:"w-2 h-2 rounded-full bg-primary-500"},pt={class:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4"},ft={key:0,class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 p-5 animate-slide-up"},gt={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-5"},bt={class:"flex justify-end gap-2 mt-4"},xt={type:"submit",class:"inline-flex items-center gap-2 px-6 py-2.5 rounded-xl bg-primary-500 hover:bg-primary-600 text-white font-medium transition-colors"},vt={key:1,class:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden"},kt={class:"overflow-x-auto"},_t={class:"w-full"},yt={class:"border-b border-slate-100 dark:border-slate-800"},ht={class:"divide-y divide-slate-100 dark:divide-slate-800"},wt={class:"px-2 py-0.5 text-xs font-medium bg-primary-100 dark:bg-primary-900/50 text-primary-700 dark:text-primary-400 rounded-full"},It={key:0},St={key:0,class:"text-xs ml-1"},Ct={key:1,class:"text-slate-400"},Nt={key:2,class:"flex flex-col items-center justify-center py-16 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800"},Tt={class:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-4"},Ht={__name:"Profit",props:{transactions:Object,summary:Object,filters:Object,cashiers:Array,customers:Array},setup(C){const i=C,y={start_date:"",end_date:"",invoice:"",cashier_id:"",customer_id:""},k=S(!1),n=S({...y,...i.filters}),h=S(null),w=S(null);G(()=>i.filters,e=>{n.value={...y,...e},h.value=i.cashiers.find(t=>String(t.id)===e.cashier_id)||null,w.value=i.customers.find(t=>String(t.id)===e.customer_id)||null},{immediate:!0});const V=(e,t)=>{n.value[e]=t},R=e=>{h.value=e,V("cashier_id",e?String(e.id):"")},U=e=>{w.value=e,V("customer_id",e?String(e.id):"")},L=()=>{O.get($("reports.profits.index"),n.value,{preserveState:!0,preserveScroll:!0}),k.value=!1},E=()=>{n.value=y,h.value=null,w.value=null,O.get($("reports.profits.index"),y,{replace:!0,preserveScroll:!0})},N=b(()=>{var e;return((e=i.transactions)==null?void 0:e.data)??[]}),T=b(()=>{var e;return((e=i.transactions)==null?void 0:e.links)??[]}),X=b(()=>{var e;return((e=i.transactions)==null?void 0:e.current_page)??1}),Z=b(()=>{var e,t;return(e=i.transactions)!=null&&e.per_page?Number((t=i.transactions)==null?void 0:t.per_page):N.value.length||1}),P=b(()=>n.value.invoice||n.value.start_date||n.value.end_date||n.value.cashier_id||n.value.customer_id),x=b(()=>{var e,t,a,I,f,A;return{profit_total:((e=i.summary)==null?void 0:e.profit_total)??0,average_profit:((t=i.summary)==null?void 0:t.average_profit)??0,orders_count:((a=i.summary)==null?void 0:a.orders_count)??0,margin:((I=i.summary)==null?void 0:I.margin)??0,best_invoice:((f=i.summary)==null?void 0:f.best_invoice)??"-",best_profit:((A=i.summary)==null?void 0:A.best_profit)??0}}),g=(e=0)=>{const t=Number(e)||0;return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t)},q=b(()=>[{title:"Total Profit",value:g(x.value.profit_total),description:"Akumulasi bersih",icon:K,gradient:"from-success-500 to-success-700"},{title:"Rata-rata Profit",value:g(x.value.average_profit),description:`${x.value.orders_count} transaksi`,icon:st,gradient:"from-primary-500 to-primary-700"},{title:"Margin Kotor",value:`${x.value.margin}%`,description:"Profit vs penjualan",icon:nt,gradient:"from-warning-500 to-warning-600"},{title:"Transaksi Terbaik",value:x.value.best_invoice,description:g(x.value.best_profit),icon:et,gradient:"from-accent-500 to-accent-700"}]),$=(e,t)=>typeof window<"u"&&window.route?window.route(e,t):"#";return(e,t)=>(d(),j(lt,null,{default:l(()=>[r(v(H),{title:"Laporan Keuntungan"}),s("div",dt,[s("div",ut,[s("div",null,[s("h1",mt,[r(v(K),{size:28,class:"text-success-500"}),t[4]||(t[4]=o(" Laporan Keuntungan ",-1))]),t[5]||(t[5]=s("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Analisis profit dan margin ",-1))]),s("button",{onClick:t[0]||(t[0]=a=>k.value=!k.value),class:J(["inline-flex items-center gap-2 px-4 py-2.5 rounded-xl border text-sm font-medium transition-colors",k.value||P.value?"bg-primary-50 border-primary-200 text-primary-700 dark:bg-primary-950/50 dark:border-primary-800 dark:text-primary-400":"bg-white border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300"])},[r(v(Y),{size:18}),t[6]||(t[6]=s("span",null,"Filter",-1)),P.value?(d(),u("span",ct)):_("",!0)],2)]),s("div",pt,[(d(!0),u(z,null,M(q.value,a=>(d(),j(it,{key:a.title,title:a.title,value:a.value,description:a.description,icon:a.icon,gradient:a.gradient},null,8,["title","value","description","icon","gradient"]))),128))]),k.value?(d(),u("div",ft,[s("form",{onSubmit:Q(L,["prevent"])},[s("div",gt,[s("div",null,[t[7]||(t[7]=s("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Tanggal Mulai ",-1)),D(s("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=a=>n.value.start_date=a),class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all"},null,512),[[F,n.value.start_date]])]),s("div",null,[t[8]||(t[8]=s("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Tanggal Akhir ",-1)),D(s("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=a=>n.value.end_date=a),class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all"},null,512),[[F,n.value.end_date]])]),s("div",null,[t[9]||(t[9]=s("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Invoice ",-1)),D(s("input",{type:"text",placeholder:"TRX-...","onUpdate:modelValue":t[3]||(t[3]=a=>n.value.invoice=a),class:"w-full h-11 px-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all"},null,512),[[F,n.value.invoice]])]),r(B,{label:"Kasir",data:C.cashiers,selected:h.value,"set-selected":R,placeholder:"Semua kasir",searchable:!0},null,8,["data","selected"]),r(B,{label:"Pelanggan",data:C.customers,selected:w.value,"set-selected":U,placeholder:"Semua pelanggan",searchable:!0},null,8,["data","selected"])]),s("div",bt,[P.value?(d(),u("button",{key:0,type:"button",onClick:E,class:"px-4 py-2.5 rounded-xl border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-slate-100 transition-colors"},[r(v(rt),{size:18})])):_("",!0),s("button",xt,[r(v(at),{size:18}),t[10]||(t[10]=o(" Terapkan ",-1))])])],32)])):_("",!0),N.value.length>0?(d(),u("div",vt,[s("div",kt,[s("table",_t,[s("thead",null,[s("tr",yt,[r(c,null,{default:l(()=>[...t[11]||(t[11]=[o("No",-1)])]),_:1}),r(c,null,{default:l(()=>[...t[12]||(t[12]=[o("Invoice",-1)])]),_:1}),r(c,null,{default:l(()=>[...t[13]||(t[13]=[o("Tanggal",-1)])]),_:1}),r(c,null,{default:l(()=>[...t[14]||(t[14]=[o("Kasir",-1)])]),_:1}),r(c,null,{default:l(()=>[...t[15]||(t[15]=[o("Pelanggan",-1)])]),_:1}),r(c,{class:"text-center"},{default:l(()=>[...t[16]||(t[16]=[o("Item",-1)])]),_:1}),r(c,{class:"text-right"},{default:l(()=>[...t[17]||(t[17]=[o("Subtotal",-1)])]),_:1}),r(c,{class:"text-right"},{default:l(()=>[...t[18]||(t[18]=[o("Diskon",-1)])]),_:1}),r(c,{class:"text-right"},{default:l(()=>[...t[19]||(t[19]=[o("Penjualan",-1)])]),_:1}),r(c,{class:"text-right"},{default:l(()=>[...t[20]||(t[20]=[o("Profit",-1)])]),_:1})])]),s("tbody",ht,[(d(!0),u(z,null,M(N.value,(a,I)=>(d(),u("tr",{key:a.id,class:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors"},[r(p,{class:"text-sm text-slate-600"},{default:l(()=>[o(m(I+1+(X.value-1)*Z.value),1)]),_:2},1024),r(p,{class:"text-sm font-semibold text-slate-900 dark:text-white"},{default:l(()=>[o(m(a.invoice),1)]),_:2},1024),r(p,{class:"text-sm text-slate-600 dark:text-slate-400"},{default:l(()=>[o(m(a.created_at),1)]),_:2},1024),r(p,{class:"text-sm text-slate-600 dark:text-slate-400"},{default:l(()=>{var f;return[o(m(((f=a.cashier)==null?void 0:f.name)??"-"),1)]}),_:2},1024),r(p,{class:"text-sm text-slate-600 dark:text-slate-400"},{default:l(()=>{var f;return[o(m(((f=a.customer)==null?void 0:f.name)??"-"),1)]}),_:2},1024),r(p,{class:"text-center"},{default:l(()=>[s("span",wt,m(a.total_items??0),1)]),_:2},1024),r(p,{class:"text-right text-sm text-slate-600 dark:text-slate-400"},{default:l(()=>[o(m(g(Number(a.grand_total||0)+Number(a.discount||0))),1)]),_:2},1024),r(p,{class:"text-right text-sm text-danger-600 dark:text-danger-400"},{default:l(()=>[Number(a.discount||0)>0?(d(),u("span",It,[o(" -"+m(g(Number(a.discount||0)))+" ",1),a.discount_type==="percent"&&a.discount_percent?(d(),u("span",St," ("+m(a.discount_percent)+"%) ",1)):_("",!0)])):(d(),u("span",Ct,"-"))]),_:2},1024),r(p,{class:"text-right text-sm font-semibold text-slate-900 dark:text-white"},{default:l(()=>[o(m(g(Number(a.grand_total||0))),1)]),_:2},1024),r(p,{class:"text-right text-sm font-semibold text-success-600 dark:text-success-400"},{default:l(()=>[o(m(g(Number(a.total_profit||0))),1)]),_:2},1024)]))),128))])])])])):(d(),u("div",Nt,[s("div",Tt,[r(v(W),{size:32,class:"text-slate-400"})]),t[21]||(t[21]=s("h3",{class:"text-lg font-medium text-slate-800 dark:text-slate-200 mb-1"}," Tidak Ada Data ",-1)),t[22]||(t[22]=s("p",{class:"text-sm text-slate-500"},"Tidak ada transaksi sesuai filter.",-1))])),T.value&&T.value.length>3?(d(),j(ot,{key:3,links:T.value},null,8,["links"])):_("",!0)])]),_:1}))}};export{Ht as default};
