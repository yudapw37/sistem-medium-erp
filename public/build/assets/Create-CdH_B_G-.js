import{T as F,r as T,A as y,a as n,c as L,w as f,b as o,u as r,Z as M,d as t,e as g,j as E,k as u,x as S,g as d,p as _,t as i,F as v,v as h,h as U,f as O,J as Q}from"./app-DA0EYa_6.js";import{I as G}from"./IconAlertCircle-Bi800bvo.js";import{I as K}from"./IconArrowLeft-gRB0gwWT.js";import{I as J}from"./IconDeviceFloppy-C77V5VA5.js";import{I as Z}from"./IconSearch-hVNvfgeb.js";import{I as W}from"./IconTrash-BZm3hFVP.js";import{_ as X}from"./DashboardLayout-DqHF1oae.js";import{_ as V}from"./TableCard-BYxyxo2i.js";import{_ as N}from"./Button-mcRGNCmf.js";import{_ as p}from"./InputError-Bj-Qp91n.js";import"./createVueComponent-CUBUAVU4.js";import"./IconUsers-CzMPbSiM.js";import"./IconSun-9pmbsCzq.js";import"./IconFileInvoice-DqQY055S.js";import"./IconReceipt-DjQT6mN-.js";import"./IconShoppingCart-qle56F5S.js";const Y={class:"mb-6"},tt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},et={class:"lg:col-span-2 space-y-6"},st={class:"p-6"},at={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},rt=["value"],lt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ot=["value"],nt={class:"p-6"},it={class:"mb-4 relative"},dt={class:"relative"},ut=["disabled","placeholder"],pt={key:0,class:"absolute z-50 left-0 right-0 mt-1 bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 overflow-hidden max-h-64 overflow-y-auto"},ct=["onClick"],bt={class:"flex justify-between items-center"},mt={class:"font-medium text-slate-900 dark:text-white"},xt={class:"text-xs text-slate-500"},ft={class:"text-right"},gt={class:"text-xs font-semibold text-slate-500"},ht={class:"text-sm font-bold text-primary-600"},kt={class:"overflow-x-auto"},yt={class:"w-full text-sm"},_t={class:"divide-y divide-slate-100 dark:divide-slate-700"},vt={class:"px-3 py-4"},wt={class:"font-medium text-slate-900 dark:text-white"},It={class:"text-xs text-slate-500"},Tt={class:"px-3 py-4"},St=["onUpdate:modelValue"],Vt={class:"px-3 py-4 text-right"},Pt=["onUpdate:modelValue"],Ct={class:"px-3 py-4 text-right"},Ut={class:"px-3 py-4 text-center"},Nt=["onClick"],Rt={key:0},zt={class:"space-y-6"},At={class:"p-6"},Dt={class:"space-y-3"},jt={class:"flex justify-between text-sm text-slate-500"},qt={class:"font-medium text-slate-900 dark:text-white"},Bt={class:"flex justify-between text-sm text-slate-500"},$t={class:"font-medium text-slate-900 dark:text-white"},Ht={class:"pt-3 border-t border-slate-100 dark:border-slate-700"},Ft={class:"flex justify-between text-base font-bold"},Lt={class:"text-primary-600"},Mt={key:0,class:"text-[10px] text-slate-400 mt-1 italic"},Et={key:1,class:"text-[10px] text-slate-400 mt-1 italic"},Ot={class:"mt-6 space-y-3"},Qt={class:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-900/30 p-4 rounded-2xl"},Gt={class:"flex gap-3"},ue={__name:"Create",props:{warehouses:Array,reasonLabels:Object,outReasons:Array,inReasons:Array},setup(w){const P=w,a=F({type:"out",reason:"",warehouse_id:"",date:new Date().toISOString().substr(0,10),notes:"",items:[]}),c=T(""),b=T([]),C=T(!1),R=y(()=>a.type==="in"?P.inReasons:P.outReasons),z=()=>{a.reason=""},A=async()=>{if(c.value.length<2){b.value=[];return}C.value=!0;try{const l=await Q.post(k("zero-value-transactions.searchProduct"),{search:c.value,warehouse_id:a.warehouse_id});b.value=l.data}catch(l){console.error("Error searching products:",l)}finally{C.value=!1}},D=l=>{const e=a.items.find(s=>s.product_id===l.id);e?e.qty++:a.items.push({product_id:l.id,title:l.title,barcode:l.barcode,qty:1,buy_price:l.buy_price}),c.value="",b.value=[]},j=l=>{a.items.splice(l,1)},q=y(()=>a.items.length),B=y(()=>a.items.reduce((l,e)=>l+e.qty,0)),$=y(()=>a.items.reduce((l,e)=>l+e.qty*e.buy_price,0)),I=l=>new Intl.NumberFormat("id-ID").format(l),k=(l,e)=>typeof window<"u"&&window.route?window.route(l,e):"#",H=()=>{a.post(k("zero-value-transactions.store"),{onSuccess:()=>{}})};return(l,e)=>(n(),L(X,null,{default:f(()=>[o(r(M),{title:"Tambah Transaksi Nilai Nol"}),t("div",Y,[o(r(E),{href:k("zero-value-transactions.index"),class:"inline-flex items-center text-sm text-slate-500 hover:text-primary-600 transition-colors mb-2"},{default:f(()=>[o(r(K),{size:16,class:"mr-1"}),e[6]||(e[6]=g(" Kembali ke Daftar ",-1))]),_:1},8,["href"]),e[7]||(e[7]=t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Tambah Transaksi Nilai Nol",-1))]),t("form",{onSubmit:O(H,["prevent"])},[t("div",tt,[t("div",et,[o(V,{title:"Detail Transaksi"},{default:f(()=>[t("div",st,[t("div",at,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[g(" Tipe Transaksi "),t("span",{class:"text-red-500"},"*")],-1)),u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>r(a).type=s),class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",onChange:z},[...e[8]||(e[8]=[t("option",{value:"out"},"Stok Keluar (Rusak/Expired/Hibah)",-1),t("option",{value:"in"},"Stok Masuk (Bonus/Hadiah)",-1)])],544),[[S,r(a).type]]),o(p,{message:r(a).errors.type},null,8,["message"])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[g(" Alasan "),t("span",{class:"text-red-500"},"*")],-1)),u(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r(a).reason=s),class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},[e[10]||(e[10]=t("option",{value:""},"Pilih Alasan",-1)),(n(!0),d(v,null,_(R.value,s=>(n(),d("option",{key:s,value:s},i(w.reasonLabels[s]),9,rt))),128))],512),[[S,r(a).reason]]),o(p,{message:r(a).errors.reason},null,8,["message"])])]),t("div",lt,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[g(" Gudang "),t("span",{class:"text-red-500"},"*")],-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(a).warehouse_id=s),class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},[e[12]||(e[12]=t("option",{value:""},"Pilih Gudang",-1)),(n(!0),d(v,null,_(w.warehouses,s=>(n(),d("option",{key:s.id,value:s.id},i(s.name),9,ot))),128))],512),[[S,r(a).warehouse_id]]),o(p,{message:r(a).errors.warehouse_id},null,8,["message"])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[g(" Tanggal "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(a).date=s),type:"date",class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"},null,512),[[h,r(a).date]]),o(p,{message:r(a).errors.date},null,8,["message"])])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Catatan ",-1)),u(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(a).notes=s),rows:"3",class:"w-full px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Opsional..."},null,512),[[h,r(a).notes]]),o(p,{message:r(a).errors.notes},null,8,["message"])])])]),_:1}),o(V,{title:"Daftar Produk"},{default:f(()=>[t("div",nt,[t("div",it,[t("div",dt,[o(r(Z),{size:18,class:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>c.value=s),type:"text",disabled:!r(a).warehouse_id,placeholder:r(a).warehouse_id?"Cari produk berdasarkan nama atau kode...":"Pilih gudang terlebih dahulu...",class:"w-full pl-10 pr-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",onInput:A},null,40,ut),[[h,c.value]])]),b.value.length>0?(n(),d("div",pt,[(n(!0),d(v,null,_(b.value,s=>{var m;return n(),d("button",{key:s.id,type:"button",class:"w-full text-left px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors border-b border-slate-100 dark:border-slate-700 last:border-0",onClick:x=>D(s)},[t("div",bt,[t("div",null,[t("p",mt,i(s.title),1),t("p",xt,i(s.barcode)+" | "+i((m=s.category)==null?void 0:m.name),1)]),t("div",ft,[t("p",gt,"Stok: "+i(s.warehouse_stock),1),t("p",ht,"Rp "+i(I(s.buy_price)),1)])])],8,ct)}),128))])):U("",!0)]),t("div",kt,[t("table",yt,[e[17]||(e[17]=t("thead",{class:"bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400 font-semibold border-b border-slate-100 dark:border-slate-700"},[t("tr",null,[t("th",{class:"px-3 py-3 text-left"},"Produk"),t("th",{class:"px-3 py-3 text-center w-32"},"Qty"),t("th",{class:"px-3 py-3 text-right"},"HPP (Satuan)"),t("th",{class:"px-3 py-3 text-right"},"Subtotal"),t("th",{class:"px-3 py-3 text-center w-16"})])],-1)),t("tbody",_t,[(n(!0),d(v,null,_(r(a).items,(s,m)=>(n(),d("tr",{key:m},[t("td",vt,[t("div",wt,i(s.title),1),t("div",It,i(s.barcode),1)]),t("td",Tt,[u(t("input",{"onUpdate:modelValue":x=>s.qty=x,type:"number",min:"1",class:"w-full px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-center"},null,8,St),[[h,s.qty,void 0,{number:!0}]])]),t("td",Vt,[u(t("input",{"onUpdate:modelValue":x=>s.buy_price=x,type:"number",min:"0",class:"w-full px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-right"},null,8,Pt),[[h,s.buy_price,void 0,{number:!0}]])]),t("td",Ct," Rp "+i(I(s.qty*s.buy_price)),1),t("td",Ut,[t("button",{type:"button",class:"text-red-500 hover:text-red-700",onClick:x=>j(m)},[o(r(W),{size:18})],8,Nt)])]))),128)),r(a).items.length===0?(n(),d("tr",Rt,[...e[16]||(e[16]=[t("td",{colspan:"5",class:"px-3 py-8 text-center text-slate-400 italic"}," Belum ada produk yang ditambahkan ",-1)])])):U("",!0)])])]),o(p,{message:r(a).errors.items},null,8,["message"])])]),_:1})]),t("div",zt,[o(V,{title:"Ringkasan"},{default:f(()=>[t("div",At,[t("div",Dt,[t("div",jt,[e[18]||(e[18]=t("span",null,"Total Item",-1)),t("span",qt,i(q.value),1)]),t("div",Bt,[e[19]||(e[19]=t("span",null,"Total Qty",-1)),t("span",$t,i(B.value),1)]),t("div",Ht,[t("div",Ft,[e[20]||(e[20]=t("span",{class:"text-slate-900 dark:text-white"},"Total Nilai (HPP)",-1)),t("span",Lt,"Rp "+i(I($.value)),1)]),r(a).type==="in"?(n(),d("p",Mt," * Untuk bonus, nilai total akan masuk sebagai pendapatan lain-lain ")):(n(),d("p",Et," * Untuk rusak/expired, nilai total akan masuk sebagai beban kerugian "))])]),t("div",Ot,[o(N,{type:"submit",class:"w-full bg-primary-500 hover:bg-primary-600 text-white shadow-lg shadow-primary-500/30 py-3",label:"Simpan Draft",disabled:r(a).processing,icon:r(J)},null,8,["disabled","icon"]),o(N,{type:"link",href:k("zero-value-transactions.index"),class:"w-full bg-slate-100 hover:bg-slate-200 text-slate-700 py-3 text-center block rounded-xl font-semibold",label:"Batal"},null,8,["href"])])])]),_:1}),t("div",Qt,[t("div",Gt,[o(r(G),{class:"text-amber-600 shrink-0",size:20}),e[21]||(e[21]=t("div",{class:"text-xs text-amber-800 dark:text-amber-400 space-y-2"},[t("p",{class:"font-bold"},"Informasi Akuntansi"),t("p",null,"Transaksi ini akan mengurangi/menambah stok tanpa ada kas yang keluar atau masuk."),t("p",null,"Sistem akan otomatis mencatat jurnal beban/pendapatan berdasarkan nilai HPP saat difinalisasi.")],-1))])])])])],32)]),_:1}))}};export{ue as default};
